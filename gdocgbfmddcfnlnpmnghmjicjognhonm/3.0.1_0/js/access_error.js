var GET_TIME="http://kproxy.local/servers.time",MAX_TIME=18E5,lTime=0,lCurrentTime=0,interval=null;document.addEventListener("DOMContentLoaded",function(){init()});
function init(){$("#disconnect").click(function(){chrome.extension.getBackgroundPage().stopKProxyAgentSignal();setTimeout(function(){window.close()},500)});console.log("init: "+Date.now());$.ajax({type:"GET",url:GET_TIME,timeout:5E3,contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){a.data&&(a=a.data[0]);var b=a.time;a=a.pro;var c=chrome.extension.getBackgroundPage().user;null!=c.login&&0!=c.login.indexOf("*cookie_")&&($(".custom_value").val(c.login),$(".action_form").attr("action",
"https://www.paypal.com/cgi-bin/webscr"));a?setServerPro():setHour(b)},error:function(a){console.log("error: "+Date.now());console.log("error");console.log(a)},complete:function(){}})}
function setServerPro(){$("#upgrade_welcome").html('<p class="wait_moment">No access to PRO servers</p><p>You haven\'t credits available.</p><p>Please,</p><p>- <b><span class="proxy_blue">Select a public server</span></b> to continue surfing, you are now using a PRO server</p><p>- <b><span class="proxy_blue">Get more credits</span></b> and enjoy all advantages of our PRO service, included our fast PRO servers.<br><br></p><p>Thank you for your patience!</p>');$("#dont_wait").html("I WANT PRO SERVERS")}
function setHour(a){MAX_TIME=a;interval=setInterval(updateClock,1E3)}function updateClock(){var a=0;0<lCurrentTime?(a=(new Date).getTime()-lCurrentTime,0>a&&(a=0),lTime=MAX_TIME-a,0>lTime&&(lTime=0,setTimeout(function(){window.close()},3E3))):(lTime=MAX_TIME,lCurrentTime=(new Date).getTime());a=parseTime(lTime);$("#hour").html(a)}function parseTime(a){a/=1E3;var b=Math.floor(a%60);return pad(Math.floor(a/60))+":"+pad(b)}function pad(a){a="0"+a;return a.substring(a.length-2)};

pluginFn['/js/plugins/v2/freehand.js'] = function(lucid, window) {
	lucid.plugin.initBlockClass({className:"FreehandBlock",name:i18n.get("plugin-freehand-name"),defaultSize:{w:240,h:240},onInit:function(c){lucid.plugin.registerProperty(c,"Stencil",{BoundingBox:{x:0,y:0,w:1,h:1},Shapes:[],Text:{},LinkPoints:[]},function(a){var d=lucid.plugin.getStencil(a);d.Container&&lucid.plugin.makeHollow(c);for(var h=lucid.plugin.getBlockTextAreas(c),e=0;e<h.length;e++)h[e]in d.Text||lucid.plugin.deleteTextArea(h[e]);lucid.object.forEach(d.Text,function(a,e){lucid.plugin.addBlockTextArea(c,
{id:e,value:lucid.plugin.getProperty(c,e)||a.Default,getBoundingBox:function(c){return{x:c.x+c.w*(a.x-d.BoundingBox.x)/d.BoundingBox.w,y:c.y+c.h*(a.y-d.BoundingBox.y)/d.BoundingBox.h,w:c.w*a.w/d.BoundingBox.w,h:c.h*a.h/d.BoundingBox.h}},wantReturn:!0,rotation:a.rotation,vAlignOverflow:!0})});return a})},getLinkPoints:function(c){var a=lucid.plugin.getStencil(lucid.plugin.getProperty(c,"Stencil")),d=[];a&&lucid.array.forEach(a.LinkPoints||[],function(c){d.push({x:(c.x-a.BoundingBox.x)/a.BoundingBox.w,
y:(c.y-a.BoundingBox.y)/a.BoundingBox.h})});return d},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth","Stencil"]},getRenderData:function(c){var a=[],d=lucid.plugin.getStencil(c.Stencil);lucid.array.forEach(d.Shapes||[],function(h){a.push(p(c,h,d))});return a}});
function p(c,a,d){function h(a){return{p1:a.p2,p2:a.p1,n1:a.n2,n2:a.n1}}var e={FillColor:a.FillColor,StrokeColor:a.StrokeColor,LineWidth:a.LineWidth,Actions:[]};"prop"==e.FillColor&&(e.FillColor=c.FillColor);"prop"==e.StrokeColor&&(e.StrokeColor=c.LineColor);"prop"==e.LineWidth&&(e.LineWidth=c.LineWidth);for(var q=[],g=lucid.array.shallowCopy(a.Lines);0<g.length;){var f=[g.shift()],l;do for(var k=l=0;k<g.length;k++){var m=f[0],n=f[f.length-1],b=g[k];if(m.p1==b.p1&&n.p2==b.p2){g.splice(k--,1);(b.n1||
b.n2)&&f.push(h(b));f.push("close");l++;break}else if(m.p1==b.p2&&n.p2==b.p1){g.splice(k--,1);(b.n1||b.n2)&&f.push(b);f.push("close");l++;break}else m.p1==b.p1?(g.splice(k--,1),f.unshift(h(b)),l++):n.p2==b.p1?(g.splice(k--,1),f.push(b),l++):m.p1==b.p2?(g.splice(k--,1),f.unshift(b),l++):n.p2==b.p2&&(g.splice(k--,1),f.push(h(b)),l++)}while(0<l&&"close"!=f[f.length-1]);q.push(f)}lucid.array.forEach(q,function(b){e.Actions.push(r(a.Points[b[0].p1],c.BoundingBox,d));e.Actions[e.Actions.length-1].Action=
"move";lucid.array.forEach(b,function(b){if("close"==b)e.Actions.push({Action:"close"});else{var f=a.Points[b.p1],g=a.Points[b.p2],h=r(g,c.BoundingBox,d);b.n1||b.n2?(f=lucid.math.Point.add(f,b.n1||{x:0,y:0}),b=lucid.math.Point.add(g,b.n2||{x:0,y:0}),g=r(f,c.BoundingBox,d),b=r(b,c.BoundingBox,d),e.Actions.push({Action:"curve",Control:[{x1:g.x,y1:g.y,x2:b.x,y2:b.y,x3:h.x,y3:h.y}]})):e.Actions.push({Action:"line",x:h.x,y:h.y})}})});return e}
function r(c,a,d){return{x:0==d.BoundingBox.w?0:a.x+a.w*(c.x-d.BoundingBox.x)/d.BoundingBox.w,y:0==d.BoundingBox.h?0:a.y+a.h*(c.y-d.BoundingBox.y)/d.BoundingBox.h}};
//# sourceMappingURL=/js/plugins/v2/source-maps/freehand.js.map

};

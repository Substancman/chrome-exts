pluginFn['/js/plugins/v2/userimage.js'] = function(lucid, window) {
	var l={};function m(b){return!b.hidden&&lucid.array.every(b.tags,function(b){return"archived"!=b.key})}var n=lucid.localStorage.get("userImageSelectedFilter"),p=m;function r(b,c){return(b.created<c.created)-(b.created>c.created)}function t(b){var c=[],g=[],e;for(e in b)b[e].isTeamImage?g.push(b[e]):c.push(b[e]);c.sort(r);g.sort(r);return{userImages:c,teamImages:g}}
lucid.plugin.initBlockClass({className:"UserImage2Block",name:i18n.get("plugin-userimages-shape-user-image-name-default"),searchKeywords:[],defaultSize:{w:160,h:120},getLinkPoints:function(){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderData:function(b){var c=b.BoundingBox;return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:c.x,y:c.y},{Action:"line",x:c.x+c.w,y:c.y},{Action:"line",x:c.x+c.w,y:c.y+c.h},{Action:"line",x:c.x,y:c.y+c.h},
{Action:"close"}]}]}});var u=lucid.config.on_premise?i18n.get("plugin-userimages-group-confluence-userimages"):i18n.get("plugin-userimages-group-userimages");
function y(){function b(a,c){for(var d="",f=0;f<c;f++)d=f==c-1?d+"- ":d+"--";f=a.tags[0].key;"archived"==f||"private"==f||e(a)||((lucid.array.some(a.tags,function(a){return a.thirdParty})?q:h).push({label:d+a.tags[0].name,value:f}),lucid.array.forEach(a.children,function(a){b(a,c+1)}))}function c(){if(!v){v=!0;var a=lucid.template.builder();a.clear();a.add({classes:"heading",text:i18n.get("plugin-userimages-divider-label-team-images")});k.push({template:a.getTemplate()})}}function g(a){p=a&&"__all__"!=
a?"__itd__"==a?function(a){return a.inDocument}:"__untagged__"==a?function(a){return 0===a.tags.length}:function(b){return lucid.array.some(b.tags,function(b){return b.key==a})}:m;n=a;lucid.localStorage.set("userImageSelectedFilter",a)}function e(a){var b=a.tags[0],c=!0;a.children.length&&(c=lucid.array.every(a.children,e));return c?!lucid.object.some(l,function(a){return lucid.array.some(a.tags,function(a){return b.key==a.key})}):!1}function w(a){p&&!1===p(a)||255<=A++||k.push({className:"UserImage2Block",
name:i18n.get("plugin-userimages-shape-user-image-name",{id:a.id}),toolBoxId:"UserImage-"+a.id,imageId:a.id,tooltip:a.name||i18n.get("plugin-userimages-shape-user-image-tooltip-unnamed"),defaultSize:{w:a.defaultSize.width,h:a.defaultSize.height},defaultProperties:function(){return{Text:"",FillColor:{pos:config.defaultImageFillPos,url:a.url},LineWidth:0,AspectRatio:a.defaultSize.width/a.defaultSize.height}},menuItems:a.isTeamImage?[]:[{label:i18n.get("plugin-userimages-shape-user-menu-delete"),action:function(){lucid.plugin.deleteUserImage(a.id)}}]})}
var A=0,k=[],x={};x["User Images"]={displayName:u,isSensitive:!0,items:k};g(n);var v=!1,d=lucid.plugin.getTagTree(),h=[{label:i18n.get("plugin-userimages-tag-option-all"),value:"__all__"},{label:i18n.get("plugin-userimages-tag-option-document"),value:"__itd__"},{label:i18n.get("plugin-userimages-tag-option-untagged"),value:"__untagged__"},{label:i18n.get("plugin-userimages-tag-option-archived"),value:"archived"},{separator:!0}];lucid.config.on_premise&&h.splice(2,2);var q=[{separator:!0}];lucid.array.forEach(d,
function(a){b(a,0)});1<q.length&&(h=h.concat(q));d=lucid.template.builder();d.open({css:{padding:"4px 6px 2px 4px"}});lucid.array.forEach(h,function(a){a.value==n&&(a.selected=!0)});d.addInput({type:"select",options:h,onChange:function(a,b){b||(g(a),y())}});d.clear();d.close();k.push({template:d.getTemplate()});k.push({template:{classes:"tool-box-block left add-button",title:i18n.get("plugin-userimages-title-tip-add-image"),click:function(){lucid.plugin.showUserImageDialog(function(){y()},{refreshImagesInDocument:!0,
useDefaultSuccess:!0,source:"add image in toolbar"})}},onlineOnly:!0});d=t(l);lucid.array.forEach(d.userImages,w);d.teamImages.length&&(c(),lucid.array.forEach(d.teamImages,w));lucid.plugin.inDemoMode()||lucid.plugin.createToolGroups(x)}if(!lucid.plugin.inDemoMode()){var z={};z["User Images"]={displayName:u,isSensitive:!0,items:[]};lucid.plugin.createToolGroups(z)}lucid.plugin.onActivate(function(){y()});lucid.plugin.onUserImagesChanged(function(b){l=b;for(var c in l);setTimeout(function(){y()},100)});
lucid.plugin.initBlockClass({className:"URLImageBlock",name:"User Image (URL)",searchKeywords:[],defaultSize:{w:120,h:120},isImageBlock:function(){return!0},disabledPropertyControls:["FillColor","FillType","LineColor","LineWidth"],onInit:function(b){lucid.plugin.registerProperty(b,"URL","")},getRenderData:function(b){return[{FillColor:{url:b.URL,pos:b.BoundingBox},Actions:lucid.math.Box.toRenderActions(b.BoundingBox)}]}});
lucid.plugin.initBlockClass({className:"UserImageBlock",name:"User Image",searchKeywords:[],defaultSize:{w:160,h:120},isImageBlock:function(){return!0},disabledPropertyControls:["FillColor","FillType","LineColor","LineWidth"],onInit:function(b){lucid.plugin.registerProperty(b,"URL","")},getRenderData:function(b){return[{FillColor:{url:b.URL,pos:b.BoundingBox},Actions:lucid.math.Box.toRenderActions(b.BoundingBox)}]},getLinkPoints:function(){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]}});
//# sourceMappingURL=/js/plugins/v2/source-maps/userimage.js.map

};

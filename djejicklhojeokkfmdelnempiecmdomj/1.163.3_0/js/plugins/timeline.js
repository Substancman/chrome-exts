pluginFn['/js/plugins/v2/timeline.js'] = function(lucid, window) {
	var g=g||{};g.scope={};g.ASSUME_ES5=!1;g.ASSUME_NO_NATIVE_MAP=!1;g.ASSUME_NO_NATIVE_SET=!1;g.defineProperty=g.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};g.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};g.global=g.getGlobal(this);g.SYMBOL_PREFIX="jscomp_symbol_";
g.initSymbol=function(){g.initSymbol=function(){};g.global.Symbol||(g.global.Symbol=g.Symbol)};g.symbolCounter_=0;g.Symbol=function(a){return g.SYMBOL_PREFIX+(a||"")+g.symbolCounter_++};g.initSymbolIterator=function(){g.initSymbol();var a=g.global.Symbol.iterator;a||(a=g.global.Symbol.iterator=g.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&g.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return g.arrayIterator(this)}});g.initSymbolIterator=function(){}};
g.arrayIterator=function(a){var b=0;return g.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};g.iteratorPrototype=function(a){g.initSymbolIterator();a={next:a};a[g.global.Symbol.iterator]=function(){return this};return a};
g.iteratorFromArray=function(a,b){g.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
g.polyfill=function(a,b){if(b){var c=g.global;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&g.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};g.polyfill("Array.prototype.keys",function(a){return a?a:function(){return g.iteratorFromArray(this,function(a){return a})}},"es6","es3");var k={LINE:"lineTimeline",BLOCK:"blockTimeline"},t={SECOND:"second",MINUTE:"minute",HOUR:"hour",DAY:"day",WEEK:"week",MONTH:"month",QUARTER:"quarter",YEAR:"year"},u={Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6};function aa(){var a=new Date(lucid.i18nDate.timelineStartOf(new Date,"day"));a.setDate(a.getDate()+7);return a}var ba=t.DAY,ca=k.BLOCK,v=new Date("January 31, 2016 16:50:45"),w={};
function da(a,b,c,d){lucid.plugin.registerProperty(a,b,"",null,function(){lucid.plugin.proxyPropertyChanged(a,c)});lucid.plugin.registerProxyProperty(a,c,function(){return lucid.plugin.getProperty(a,b)},function(c){var e=lucid.plugin.getAllProperties(a);c&&e.TimelineBlockId?(c=d(new Date(c),e.TimelineBlockId),e[b]=c.toISOString(),c=y(lucid.plugin.getBlockClassName(a),e,lucid.plugin.getAllProperties(e.TimelineBlockId)),lucid.plugin.setPropertyIfChanged(a,b,e[b]),lucid.plugin.setPropertyIfChanged(a,
"BoundingBox",c)):A(a)})}
function B(a,b,c){lucid.plugin.registerProperty(a,b,"");lucid.plugin.hookPropertyPostSave(a,b,function(d,e){d=lucid.plugin.getSomeProperties(a,["TimelineBlockId","BoundingBox","MilestoneDate","StartDate","FinishDate",b]);e?d&&d.StartDate&&d.FinishDate&&(e=c(new Date(e),d.TimelineBlockId),d[b]=e.toISOString(),e=lucid.plugin.getSomeProperties(d.TimelineBlockId,["BoundingBox","StartDate","FinishDate","TimelineType"]))&&(e=y(lucid.plugin.getBlockClassName(a),d,e),lucid.plugin.setPropertyIfChanged(a,b,
d[b]),lucid.plugin.setPropertyIfChanged(a,"BoundingBox",e)):A(a)})}function C(a){lucid.plugin.registerProperty(a,"TimelineBlockId","",null,function(b,c){b&&w[b]&&w[b].attachedBlockIds&&delete w[b].attachedBlockIds[a];c&&(w[c]||(w[c]={}),w[c].attachedBlockIds||(w[c].attachedBlockIds={}),w[c].attachedBlockIds[a]=!0,b!==c&&lucid.plugin.proxyPropertyChanged(a,"DateFormatOptions"))})}
function ea(a,b){switch(b){case t.SECOND:case t.MINUTE:case t.HOUR:b="h:mm A;h:mm a;H:mm;h A;h a;D MMMM h:mm A;D MMMM H:mm;MMM D h:mm A;MMM D H:mm;MMMM D h:mm A;D MMM h:mm A".split(";");break;default:b="D MMMM YYYY;MMM D;MMMM D, YYYY;MMM D, YYYY;M/D/YYYY;M/D;D-M-YYYY;D MMM;D-M".split(";");break;case t.MONTH:case t.QUARTER:b="MMMM;MMM;MMMM YYYY;MM/YYYY;MMM YYYY;MMM D;MMM D, YYYY;M/D/YYYY;M/D;D-M-YYYY;D MMM;D-M".split(";");break;case t.YEAR:b="YYYY;MMMM YYYY;MM/YYYY;MMM YYYY;MMM D, YYYY;M/D/YYYY;D-M-YYYY;D MMM YYYY".split(";")}return b.map(function(b){return{label:lucid.i18nDate.specifiedFormat(b,
v,lucid.plugin.getProperty(a,"Language")),value:b}})}function D(a,b){lucid.plugin.registerProxyProperty(a,"DateFormatOptions",function(){var c=b?a:lucid.plugin.getProperty(a,"TimelineBlockId");c=ea(a,lucid.plugin.getProperty(c,"TimeUnit"));var d=lucid.plugin.getProperty(a,"DateFormat");0<lucid.array.filter(c,function(a){return a.value===d}).length||c.push({label:lucid.i18nDate.specifiedFormat(d,v,lucid.plugin.getProperty(a,"Language")),value:d});return c},function(){})}
function E(a,b,c,d){return(b.getTime()-a.getTime())/(d.getTime()-c.getTime())}function F(a,b,c,d){return d.x+E(b,a,b,c)*d.w}
function G(a,b,c){switch(c){case t.SECOND:b.setSeconds(b.getSeconds()+1*a);break;case t.MINUTE:b.setMinutes(b.getMinutes()+1*a);break;case t.HOUR:b.setHours(b.getHours()+1*a);break;case t.DAY:b.setDate(b.getDate()+1*a);break;case t.WEEK:b.setDate(b.getDate()+7*a);break;case t.MONTH:b.setMonth(b.getMonth()+1*a);break;case t.QUARTER:b.setMonth(b.getMonth()+3*a);break;case t.YEAR:b.setYear(b.getFullYear()+1*a)}return b}
function I(a,b,c){switch(c){case t.SECOND:b.setSeconds(b.getSeconds()-1*a);break;case t.MINUTE:b.setMinutes(b.getMinutes()-1*a);break;case t.HOUR:b.setHours(b.getHours()-1*a);break;case t.DAY:b.setDate(b.getDate()-1*a);break;case t.WEEK:b.setDate(b.getDate()-7*a);break;case t.MONTH:b.setMonth(b.getMonth()-1*a);break;case t.QUARTER:b.setMonth(b.getMonth()-3*a);break;case t.YEAR:b.setYear(b.getFullYear()-1*a)}return b}function J(a,b,c){var d=new Date(a);d=G(1,d,c);return E(a,d,a,b)}
function K(a,b,c){return lucid.i18nDate.timelineDiff(a,b,c)}
function fa(a){lucid.plugin.registerProxyProperty(a,"TimeUnitOptions",function(){var b=new Date(lucid.plugin.getProperty(a,"StartDate")),c=new Date(lucid.plugin.getProperty(a,"FinishDate"));return[{label:i18n.get("plugin-timeline-time-unit-option-seconds"),value:"second",disabled:function(){return 75<K(b,c,"second")}},{label:i18n.get("plugin-timeline-time-unit-option-minutes"),value:"minute",disabled:function(){return 75<K(b,c,"minute")}},{label:i18n.get("plugin-timeline-time-unit-option-hours"),
value:"hour",disabled:function(){return 75<K(b,c,"hour")}},{label:i18n.get("plugin-timeline-time-unit-option-days"),value:"day",disabled:function(){return 75<K(b,c,"day")}},{label:i18n.get("plugin-timeline-time-unit-option-weeks"),value:"week",disabled:function(){return 75<K(b,c,"week")}},{label:i18n.get("plugin-timeline-time-unit-option-months"),value:"month",disabled:function(){return 75<K(b,c,"month")}},{label:i18n.get("plugin-timeline-time-unit-option-quarters"),value:"quarter",disabled:function(){return 75<
K(b,c,"quarter")}},{label:i18n.get("plugin-timeline-time-unit-option-years"),value:"year",disabled:function(){return 75<K(b,c,"year")}}]},function(){});lucid.plugin.hookPropertyPostSave(a,"StartDate",function(){lucid.plugin.proxyPropertyChanged(a,"TimeUnitOptions")});lucid.plugin.hookPropertyPostSave(a,"FinishDate",function(){lucid.plugin.proxyPropertyChanged(a,"TimeUnitOptions")})}
function L(a,b){function c(a){var b=new Date(f);b=lucid.i18nDate.timelineStartOf(b,a);for(b=G(1,b,a);b<h;)d(b),b=G(1,b,a)}function d(b){var c=E(f,b,f,h),d="tickMark_"+z;b=lucid.i18nDate.specifiedFormat(lucid.plugin.getProperty(a,"InterimDateFormat"),b,lucid.plugin.getProperty(a,"Language"));var e=J(f,h,l),m=lucid.text.getStyle(a,"startDateText",!0);!0===lucid.plugin.getProperty(a,"DisplayInterimMarks")&&!0===lucid.plugin.getProperty(a,"DisplayInterimDates")&&(lucid.plugin.addBlockTextArea(a,{id:d,
value:b,align:"center",vAlign:"top",readOnly:!0,getBoundingBox:function(a){return{x:a.x+a.w*c-a.w*e/2,y:a.y+a.h-10,w:a.w*e,h:30}}}),0<Object.keys(m).length&&(b=lucid.text.restyle(b,m)),lucid.plugin.setProperty(a,d,b));x.push(c);z++}var e,f=new Date(lucid.plugin.getProperty(a,"StartDate")),h=new Date(lucid.plugin.getProperty(a,"FinishDate")),l=lucid.plugin.getProperty(a,"TimeUnit"),x=[],z=0;for(e=0;void 0!==lucid.plugin.getProperty(a,"tickMark_"+e);e++)lucid.plugin.deleteBlockTextArea(a,"tickMark_"+
e);switch(l){default:c(l);break;case t.WEEK:e=new Date(f.getTime());var m=u[lucid.plugin.getProperty(a,"StartOfWeek")]-f.getDay();0>m&&(m+=7);for(e.setDate(e.getDate()+m);e<h;e=G(1,e,"week"))d(e);break;case t.QUARTER:m=(new Date(lucid.plugin.getProperty(a,"StartOfFiscalYear"))).setYear(f.getFullYear());var n=new Date(m);for(e=0;n>f;)e--,n=new Date(m),n=G(e,n,"quarter");for(;n<h;)n>f&&d(n),n=new Date(m),n=G(e,n,"quarter"),e++}lucid.plugin.setPropertyIfChanged(a,"tickMarks",x,!0);if(!b){b=lucid.plugin.getProperty(a,
"BoundingBox");for(var p in M(a))switch(lucid.plugin.getBlockClassName(p)){case "TimelineMilestoneBlock":e=new Date(lucid.plugin.getProperty(p,"milestoneDate"));0>e-f||0<e-h?(A(p),e=lucid.plugin.getProperty(p,"BoundingBox"),e.y=b.y-e.h-50,lucid.plugin.setPropertyIfChanged(p,"BoundingBox",e)):lucid.plugin.setProperty(p,"milestoneDate",e.toISOString());break;case "TimelineIntervalBlock":e=new Date(lucid.plugin.getProperty(p,"StartDate")),m=new Date(lucid.plugin.getProperty(p,"FinishDate")),0>e-f||0<
m-h?(A(p),e=lucid.plugin.getProperty(p,"BoundingBox"),e.y=b.y-e.h-50,lucid.plugin.setPropertyIfChanged(p,"BoundingBox",e)):(lucid.plugin.setProperty(p,"StartDate",e.toISOString()),lucid.plugin.setProperty(p,"FinishDate",m.toISOString()))}}}function ia(){return lucid.object.filter(w,function(a,b){return lucid.plugin.isPermanentObject(b)})}function M(a){return lucid.object.filter(w[a].attachedBlockIds,function(a,c){return lucid.plugin.isPermanentObject(c)})}
function y(a,b,c){var d=c.BoundingBox,e=new Date(c.StartDate),f=new Date(c.FinishDate);switch(a){case "TimelineMilestoneBlock":switch(c.TimelineType){case k.LINE:var h=d.y+d.h/2-b.BoundingBox.h-5;break;default:h=d.y-b.BoundingBox.h+b.BoundingBox.w-2}return{x:F(new Date(b.MilestoneDate),e,f,d)-b.BoundingBox.w/2,y:h,w:b.BoundingBox.w,h:b.BoundingBox.h};case "TimelineIntervalBlock":switch(c.TimelineType){case k.LINE:a=40;h=d.y+d.h/2-a/2;break;default:h=d.y,a=d.h-40}c=new Date(b.StartDate);var l=new Date(b.FinishDate);
b=F(c,e,f,d);d=E(c,l,e,f)*d.w;return{x:b,y:h,w:d,h:a}}}function N(a){switch(a){case t.SECOND:return t.SECOND;case t.MINUTE:return t.MINUTE;case t.HOUR:return t.HOUR;default:return t.DAY}}function O(a,b,c,d){d.w=0<d.w?d.w:1;return new Date(b.getTime()+(c.getTime()-b.getTime())*(a-d.x)/d.w)}
function P(a,b){var c=new Date(lucid.plugin.getProperty(b,"StartDate")),d=new Date(lucid.plugin.getProperty(b,"FinishDate")),e=lucid.plugin.getProperty(b,"BoundingBox");a=O(a,c,d,e);c=new Date(lucid.plugin.getProperty(b,"StartDate"));d=new Date(lucid.plugin.getProperty(b,"FinishDate"));b=lucid.plugin.getProperty(b,"TimeUnit");b=N(b);e=new Date(a);e=lucid.i18nDate.timelineStartOf(e,b);var f=new Date(e);f=G(1,f,b);e=e>c?e:c;f=f<d?f:d;return a-e<f-a?e:f}
function Q(a){lucid.plugin.setPropertyIfChanged(a,"ZOrder",lucid.plugin.getProperty("DragBlock","ZOrder")||lucid.plugin.getProperty(a,"ZOrder"))}function R(a){switch(a){case "TimelineMilestoneBlock":return{MilestoneDate:"",TimelineBlockId:""};case "TimelineIntervalBlock":return{StartDate:"",FinishDate:"",TimelineBlockId:""}}}function A(a){var b=lucid.plugin.getBlockClassName(a);b=R(b);for(var c in b)lucid.plugin.setPropertyIfChanged(a,c,b[c])}
function S(a,b,c){switch(a.TimelineType){case k.LINE:return c?lucid.math.Box.add(a.BoundingBox,b):{x:a.BoundingBox.x+b.x,y:a.BoundingBox.y,w:a.BoundingBox.w+b.w,h:a.BoundingBox.h};default:return lucid.math.Box.add(a.BoundingBox,b)}}
function T(a,b,c,d,e,f,h){b={};e=lucid.plugin.getAllProperties(a);var l=e.TimelineBlockId,x=lucid.plugin.getBlockClassName(a);if(f&&0<=f.indexOf(l))return d=lucid.plugin.getAllProperties(l),d.BoundingBox=S(d,c,h),b[a]={BoundingBox:y(x,lucid.plugin.getAllProperties(a),d)},b;a:{h=e.BoundingBox;switch(x){case "TimelineMilestoneBlock":h=lucid.math.Box.add(h,{x:c.x-c.w/2,y:c.y,w:c.w,h:c.h+c.w});break a;case "TimelineIntervalBlock":h=lucid.math.Box.add(h,c);break a}h=void 0}f=lucid.plugin.getProperty(l,
"BoundingBox");c=!1;var z;if(!l||!f||!lucid.math.Box.overlap(h,f)){l=null;for(var m in ia())if(lucid.plugin.getItemPageId(m)===lucid.plugin.getActivePageId()&&lucid.plugin.getParent(m)===lucid.plugin.getParent(a)&&(f=lucid.plugin.getProperty(m,"BoundingBox"),lucid.math.Box.overlap(h,f))){l=m;c=!0;var n=z=void 0;m=x;f=l;switch(m){case "TimelineMilestoneBlock":n=3;break;case "TimelineIntervalBlock":n=1}n=lucid.plugin.getProperty(f,"ZOrder")+n;var p=n+1;for(z in M(f))lucid.plugin.getBlockClassName(z)===
m&&(f=lucid.plugin.getProperty(z,"ZOrder"),f>n&&(n=f));z=n+Math.random()*(p-n);break}}if(l){e.TimelineBlockId=l;e.DateFormat=c?lucid.plugin.getProperty(l,"InterimDateFormat"):lucid.plugin.getProperty(a,"DateFormat");e.BoundingBox=h;a:{l=e.TimelineBlockId;h=e.BoundingBox;switch(x){case "TimelineMilestoneBlock":e.MilestoneDate=P(h.x+h.w/2,l).toISOString();d={MilestoneDate:e.MilestoneDate,TimelineBlockId:l,BoundingBox:y(x,e,lucid.plugin.getAllProperties(l))};break a;case "TimelineIntervalBlock":m=new Date(lucid.plugin.getProperty(l,
"StartDate"));f=new Date(lucid.plugin.getProperty(l,"FinishDate"));p=lucid.plugin.getProperty(l,"BoundingBox");n=N(lucid.plugin.getProperty(l,"TimeUnit"));if(d.left&&!d.right){var q=e.StartDate?new Date(e.StartDate):P(h.x,l);var r=P(h.x+h.w,l)}else if(!d.left&&d.right)q=P(h.x,l),r=e.FinishDate?new Date(e.FinishDate):P(h.x+h.w,l);else if(!d.left&&!d.right){q=P(h.x,l);r=P(h.x+h.w,l);var H=Math.abs(O(h.x,m,f,p)-q);var ha=Math.abs(O(h.x+h.w,m,f,p)-r);H=H<ha?"left":"right"}d.right||"left"===H?(d.right||
(r=F(q,m,f,p),r=P(r+h.w,l)),0<=q-f&&(q=I(1,q,"milliseconds"),q=lucid.i18nDate.timelineStartOf(q,n))):(d.left||(q=F(r,m,f,p),q=P(q-h.w,l)),0<=m-r&&(r=G(1,r,n),r=lucid.i18nDate.timelineStartOf(r,n)));0>=r-q&&(d.left||"left"===H?(r=G(1,r,n),r=r<f?r:f):(q=I(1,q,n),q=q>m?q:m));e.StartDate=q.toISOString();e.FinishDate=r.toISOString();d={StartDate:e.StartDate,FinishDate:e.FinishDate,TimelineBlockId:l,BoundingBox:y(x,e,lucid.plugin.getAllProperties(l))};break a}d=void 0}b[a]=d;c&&(b[a].DateFormat=e.DateFormat,
b[a].ZOrder=z)}else b[a]=R(x),b[a].BoundingBox=h;return b}function U(a,b,c){return[{Action:"move",x:a,y:b},{Action:"line",x:a,y:c}]}function V(a,b,c,d){return[{Action:"move",x:a,y:b},{Action:"line",x:a+c,y:b},{Action:"line",x:a+c,y:b+d},{Action:"line",x:a,y:b+d},{Action:"close"}]}function W(a){return{StrokeColor:"#00000000",FillColor:"#00000000",Actions:V(a.x,a.y,a.w,a.h)}}function X(a){return{TimelineType:a,LineColor:"#3d4752",FillColor:"#3d4752",LineWidth:2}}
function Y(a){switch(a){case t.SECOND:return t.MINUTE;case t.MINUTE:return t.HOUR;case t.HOUR:return t.DAY;case t.DAY:return t.WEEK;case t.WEEK:return t.MONTH;case t.MONTH:return t.QUARTER;default:return t.YEAR}}function Z(a){return"[object Date]"!==Object.prototype.toString.call(a)||isNaN(a.getTime())?!1:!0}
lucid.plugin.initBlockClass({className:"TimelineBlock",name:i18n.get("plugin-timeline-shape-timeline-name"),searchKeywords:i18n.get("plugin-timeline-shape-timeline-keywords"),noLines:!0,disabledPropertyControls:"FlipX FlipY left center right justified TextVAlign".split(" "),isTextRotateDisabled:!0,rLock:!0,minHeight:40,variants:{BlockTimeline:{tooltip:i18n.get("plugin-timeline-shape-timeline-variant-block-tooltip"),defaultSize:{w:1120,h:120},defaultProperties:function(){return X(k.BLOCK)}},LineTimeline:{tooltip:i18n.get("plugin-timeline-shape-timeline-variant-line-tooltip"),
defaultSize:{w:1120,h:80},defaultProperties:function(){return X(k.LINE)}}},onCreate:function(){},onInit:function(a){function b(){L(a,!1)}function c(a,b){a!==b&&d()}function d(){if(!0===lucid.plugin.getProperty(a,"DisplayStartFinishMarks")&&!0===lucid.plugin.getProperty(a,"DisplayStartFinishDates")){var b=new Date(lucid.plugin.getProperty(a,"StartDate")),c=new Date(lucid.plugin.getProperty(a,"FinishDate"));lucid.plugin.setProperty(a,"startDateText",lucid.i18nDate.specifiedFormat(lucid.plugin.getProperty(a,
"StartFinishDateFormat"),b,lucid.plugin.getProperty(a,"Language")));lucid.plugin.setProperty(a,"finishDateText",lucid.i18nDate.specifiedFormat(lucid.plugin.getProperty(a,"StartFinishDateFormat"),c,lucid.plugin.getProperty(a,"Language")))}else lucid.plugin.setProperty(a,"startDateText","",!0),lucid.plugin.setProperty(a,"finishDateText","",!0)}function e(a){return!0===a}w[a]||(w[a]={});w[a].attachedBlockIds||(w[a].attachedBlockIds={});var f=lucid.i18nDate.timelineStartOf(new Date,"day"),h=aa(),l=new Date((new Date).getFullYear(),
0,1);lucid.plugin.registerProperty(a,"StartDate",f.toISOString(),function(b){return Z(new Date(b))?b:lucid.plugin.getProperty(a,"StartDate")});lucid.plugin.registerProperty(a,"FinishDate",h.toISOString(),function(b){return Z(new Date(b))?b:lucid.plugin.getProperty(a,"FinishDate")});lucid.plugin.hookPropertyPostSave(a,"StartDate",function(b,c){if(b!==c&&(c=new Date(c),Z(c))){var d=new Date(lucid.plugin.getProperty(a,"FinishDate")),e=lucid.plugin.getProperty(a,"TimeUnit");Z(d)&&0>=d-c&&(b=new Date(b),
Z(b)?(b=d.getTime()-b.getTime(),d.setTime(c.getTime()+b)):d.setDate(c.getDate()+7),lucid.plugin.setPropertyIfChanged(a,"FinishDate",d.toISOString()));for(;"year"!==e&&75<K(c,d,e);)e=Y(e);lucid.plugin.setPropertyIfChanged(a,"TimeUnit",e);75<K(c,d,e)&&(lucid.plugin.setPropertyIfChanged(a,"DisplayStartFinishDates",!1),lucid.plugin.setPropertyIfChanged(a,"DisplayInterimDates",!1))}});lucid.plugin.hookPropertyPostSave(a,"FinishDate",function(b,c){if(b!==c&&(c=new Date(c),Z(c))){var d=new Date(lucid.plugin.getProperty(a,
"StartDate")),e=lucid.plugin.getProperty(a,"TimeUnit");Z(d)&&0>=c-d&&(b=new Date(b),Z(b)?(b=b.getTime()-d.getTime(),d.setTime(c.getTime()-b)):d.setDate(c.getDate()-7),lucid.plugin.setPropertyIfChanged(a,"StartDate",d.toISOString()));for(;"year"!==e&&75<K(d,c,e);)e=Y(e);75<K(d,c,e)&&(lucid.plugin.setPropertyIfChanged(a,"DisplayStartFinishDates",!1),lucid.plugin.setPropertyIfChanged(a,"DisplayInterimDates",!1));lucid.plugin.setPropertyIfChanged(a,"TimeUnit",e)}});lucid.plugin.registerProperty(a,"StartOfWeek",
"Sunday");lucid.plugin.registerProperty(a,"StartOfFiscalYear",l.toISOString());lucid.plugin.registerProperty(a,"TimeUnit",ba,null,function(){lucid.plugin.proxyPropertyChanged(a,"DateFormatOptions");for(var b in M(a))lucid.plugin.proxyPropertyChanged(b,"DateFormatOptions")});lucid.plugin.registerProperty(a,"TimelineType",ca,null,function(){lucid.plugin.proxyPropertyChanged(a,"timelineType")});lucid.plugin.registerProperty(a,"DisplayStartFinishMarks",!0,e);lucid.plugin.registerProperty(a,"DisplayStartFinishDates",
!0,e,function(){lucid.plugin.proxyPropertyChanged(a,"DisplayDates")});lucid.plugin.registerProperty(a,"StartFinishDateFormat","M/D",null,function(){lucid.plugin.proxyPropertyChanged(a,"DateFormat")});lucid.plugin.registerProperty(a,"DisplayInterimMarks",!0,e);lucid.plugin.registerProperty(a,"DisplayInterimDates",!0,e,function(){lucid.plugin.proxyPropertyChanged(a,"DisplayDates")});lucid.plugin.registerProperty(a,"InterimDateFormat","M/D",null,function(){lucid.plugin.proxyPropertyChanged(a,"DateFormat")});
lucid.plugin.registerProxyProperty(a,"DisplayDates",function(){return lucid.plugin.getProperty(a,"DisplayStartFinishDates")&&lucid.plugin.getProperty(a,"DisplayInterimDates")},function(b){lucid.plugin.setPropertyIfChanged(a,"DisplayStartFinishDates",b);lucid.plugin.setPropertyIfChanged(a,"DisplayInterimDates",b)});lucid.plugin.registerProxyProperty(a,"DateFormat",function(){return lucid.plugin.getProperty(a,"InterimDateFormat")},function(b){lucid.plugin.setPropertyIfChanged(a,"StartFinishDateFormat",
b);lucid.plugin.setPropertyIfChanged(a,"InterimDateFormat",b)});lucid.plugin.registerProperty(a,"Language",i18n.getLanguage(),null,function(){lucid.plugin.proxyPropertyChanged(a,"languageProxy")});D(a,!0);fa(a);lucid.plugin.hookPropertyPreSave(a,"StartOfWeek",function(a){return a});lucid.plugin.hookPropertyPreSave(a,"StartOfFiscalYear",function(b){b=new Date(b);return Z(b)?b.toISOString():lucid.plugin.getProperty(a,"StartOfFiscalYear")});lucid.plugin.hookPropertyPreSave(a,"TimeUnit",function(b){for(var c in t)if(t[c]===
b)return b;return lucid.plugin.getProperty(a,"TimeUnit")});lucid.plugin.hookPropertyPreSave(a,"StartFinishDateFormat",function(b){return"string"===typeof b?b:lucid.plugin.getProperty(a,"StartFinishDateFormat")});lucid.plugin.hookPropertyPreSave(a,"InterimDateFormat",function(b){return"string"===typeof b?b:lucid.plugin.getProperty(a,"InterimDateFormat")});lucid.plugin.addBlockTextArea(a,{id:"startDateText",value:lucid.i18nDate.specifiedFormat("M/D",f,"en"),align:"center",vAlign:"top",readOnly:!0,getBoundingBox:function(b){var c=
lucid.plugin.getAllProperties(a);c=b.w*J(new Date(c.StartDate),new Date(c.FinishDate),c.TimeUnit);return{x:b.x-c/2,y:b.y+b.h+10,w:c,h:30}}});lucid.plugin.addBlockTextArea(a,{id:"finishDateText",value:lucid.i18nDate.specifiedFormat("M/D",h,"en"),align:"center",vAlign:"top",readOnly:!0,getBoundingBox:function(b){var c=lucid.plugin.getAllProperties(a);c=b.w*J(new Date(c.StartDate),new Date(c.FinishDate),c.TimeUnit);return{x:b.x+b.w-c/2,y:b.y+b.h+10,w:c,h:30}}});L(a,!0);lucid.plugin.hookPropertyPostSave(a,
"StartDate",c);lucid.plugin.hookPropertyPostSave(a,"DisplayStartFinishMarks",c);lucid.plugin.hookPropertyPostSave(a,"DisplayStartFinishDates",c);lucid.plugin.hookPropertyPostSave(a,"FinishDate",c);lucid.plugin.hookPropertyPostSave(a,"DisplayStartFinishMarks",c);lucid.plugin.hookPropertyPostSave(a,"DisplayStartFinishDates",c);lucid.plugin.hookPropertyPostSave(a,"StartFinishDateFormat",c);lucid.plugin.hookPropertyPostSave(a,"StartDate",b);lucid.plugin.hookPropertyPostSave(a,"FinishDate",b);lucid.plugin.hookPropertyPostSave(a,
"StartOfWeek",b);lucid.plugin.hookPropertyPostSave(a,"StartOfFiscalYear",b);lucid.plugin.hookPropertyPostSave(a,"TimeUnit",b);lucid.plugin.hookPropertyPostSave(a,"DisplayInterimMarks",b);lucid.plugin.hookPropertyPostSave(a,"DisplayInterimDates",b);lucid.plugin.hookPropertyPostSave(a,"InterimDateFormat",b);lucid.plugin.hookPropertyPostSave(a,"Language",function(){var c=lucid.plugin.getProperty(a,"Language");lucid.plugin.setProperty(a,"languageText",c,!0);d();b();lucid.plugin.proxyPropertyChanged(a,
"DateFormatOptions")});lucid.plugin.registerProxyProperty(a,"languageProxy",function(){},function(){lucid.plugin.setPropertyIfChanged(a,"Language")});lucid.plugin.registerProxyProperty(a,"timelineType",function(){return lucid.plugin.getProperty(a,"TimelineType")},function(b){var c,d;for(d in k)k[d]===b&&(c=b);c=c||lucid.plugin.getProperty(a,"TimelineType");lucid.plugin.setPropertyIfChanged(a,"TimelineType",c);b=lucid.plugin.getAllProperties(a);b.TimelineType=c;switch(c){case k.LINE:b.BoundingBox.y=
b.BoundingBox.y+b.BoundingBox.h-80;b.BoundingBox.h=80;break;case k.BLOCK:b.BoundingBox.y=b.BoundingBox.y+b.BoundingBox.h-40-80,b.BoundingBox.h=120}lucid.plugin.setPropertyIfChanged(a,"BoundingBox",b.BoundingBox);for(var e in M(a))c=lucid.plugin.getAllProperties(e),lucid.plugin.setPropertyIfChanged(e,"BoundingBox",y(lucid.plugin.getBlockClassName(e),c,b))})},getOffsetProperties:function(a,b,c,d,e,f,h){b={};d=lucid.plugin.getAllProperties(a);d.BoundingBox=S(d,c,h);b[a]={BoundingBox:d.BoundingBox};for(var l in M(a))b[l]=
{BoundingBox:y(lucid.plugin.getBlockClassName(l),lucid.plugin.getAllProperties(l),d)};return b},getRenderData:function(a){var b=a.BoundingBox,c=[],d=[],e=a.tickMarks;if(!0===a.DisplayStartFinishMarks)switch(a.TimelineType){case k.LINE:c=U(b.x,b.y,b.y+b.h).concat(U(b.x+b.w,b.y,b.y+b.h));break;default:c=U(b.x,b.y,b.y+b.h).concat(U(b.x+b.w,b.y,b.y+b.h))}if(!0===a.DisplayInterimMarks)for(var f=0;f<e.length;f++)switch(a.TimelineType){case k.LINE:d=d.concat(U(b.x+b.w*e[f],b.y+b.h/4,b.y+3*b.h/4));break;
default:d=d.concat(U(b.x+b.w*e[f],b.y+b.h-40,b.y+b.h-20))}switch(a.TimelineType){case k.LINE:return[W(b),{StrokeColor:a.LineColor,LineWidth:a.LineWidth,Actions:[{Action:"move",x:b.x,y:b.y+b.h/2},{Action:"line",x:b.x+b.w,y:b.y+b.h/2}].concat(c).concat(d)}];default:return[W(b),{StrokeColor:a.LineColor,LineWidth:a.LineWidth,FillColor:a.FillColor,NoRounding:!0,Actions:V(b.x,b.y,b.w,b.h-40)},{StrokeColor:a.LineColor,LineWidth:a.LineWidth,Actions:c.concat(d)}]}},beforeDelete:function(a){for(var b in M(a))A(b)},
onDelete:function(a){delete w[a]}});
lucid.plugin.initBlockClass({className:"TimelineMilestoneBlock",name:i18n.get("plugin-timeline-shape-milestone-name"),searchKeywords:"",defaultSize:{w:20,h:80},minWidth:1,noLines:!0,disabledPropertyControls:"FlipX FlipY left center right justified TextVAlign".split(" "),isTextRotateDisabled:!0,rLock:!0,snapSpacing:1,defaultProperties:function(){return{LineColor:"#ed6058",FillColor:"#ed6058",LineWidth:2}},onCreate:Q,onPaste:A,getOffsetProperties:T,onInit:function(a){function b(){var b=lucid.plugin.getProperty(a,
"MilestoneDate"),d=lucid.plugin.getProperty(a,"DateFormat");b?lucid.plugin.setProperty(a,"dateText",lucid.i18nDate.specifiedFormat(d,new Date(b),lucid.plugin.getProperty(a,"Language")),!0):lucid.plugin.setProperty(a,"dateText","",!0)}lucid.plugin.addBlockTextArea(a,{id:"MilestoneText",value:i18n.get("plugin-timeline-shape-name-milestone-defaulttext"),align:"center",vAlign:"bottom",getBoundingBox:function(a){return{x:a.x+a.w/2-80,y:a.y-50,w:160,h:30}}});lucid.plugin.addBlockTextArea(a,{id:"dateText",
value:"",align:"center",vAlign:"top",readOnly:!0,getBoundingBox:function(a){return{x:a.x+a.w/2-240,y:a.y-20,w:480,h:30}}});lucid.plugin.registerProperty(a,"Language",i18n.getLanguage(),null,function(){lucid.plugin.proxyPropertyChanged(a,"languageProxy")});da(a,"MilestoneDate","milestoneDate",function(b,d){var c=new Date(lucid.plugin.getProperty(d,"StartDate"));d=new Date(lucid.plugin.getProperty(d,"FinishDate"));return!Z(b)||0>b-c||0>d-b?new Date(lucid.plugin.getProperty(a,"MilestoneDate")):b});C(a);
lucid.plugin.registerProperty(a,"DateFormat","M/D",function(b){return"string"===typeof b?b:lucid.plugin.getProperty(a,"DateFormat")});D(a,!1);lucid.plugin.hookPropertyPostSave(a,"MilestoneDate",b);lucid.plugin.hookPropertyPostSave(a,"DateFormat",b);lucid.plugin.hookPropertyPostSave(a,"Language",function(){var c=lucid.plugin.getProperty(a,"Language");lucid.plugin.setProperty(a,"languageText",c,!0);b();lucid.plugin.proxyPropertyChanged(a,"DateFormatOptions")});lucid.plugin.registerProxyProperty(a,"languageProxy",
function(){},function(){lucid.plugin.setPropertyIfChanged(a,"Language")})},getRenderData:function(a){var b=a.BoundingBox;return[W(b),{StrokeColor:a.LineColor,LineWidth:a.LineWidth,Actions:U(b.x+b.w/2,b.y,b.y+b.h-b.w)},{StrokeColor:a.LineColor,LineWidth:a.LineWidth,FillColor:a.FillColor,NoRounding:!0,Actions:[{Action:"move",x:b.x,y:b.y+b.h-b.w},{Action:"line",x:b.x+b.w,y:b.y+b.h-b.w},{Action:"line",x:b.x+b.w/2,y:b.y+b.h-0},{Action:"close"}]}]},beforeDelete:function(a){lucid.plugin.setPropertyIfChanged(a,
"TimelineBlockId","")}});
lucid.plugin.initBlockClass({className:"TimelineIntervalBlock",name:i18n.get("plugin-timeline-shape-interval-name"),searchKeywords:i18n.get("plugin-timeline-shape-interval-keywords"),defaultSize:{w:160,h:80},minWidth:1,noLines:!0,disabledPropertyControls:"FlipX FlipY left center right justified TextVAlign".split(" "),isTextRotateDisabled:!0,rLock:!0,snapSpacing:1,defaultProperties:function(){return{FillColor:"#9ed973",LineWidth:0}},onCreate:Q,onPaste:A,getOffsetProperties:T,onInit:function(a){function b(){var b=
lucid.plugin.getProperty(a,"StartDate"),d=lucid.plugin.getProperty(a,"FinishDate"),e=lucid.plugin.getProperty(a,"DateFormat");b&&d?(d=new Date(d),lucid.plugin.setProperty(a,"dateText",lucid.i18nDate.specifiedFormat(e,new Date(b),lucid.plugin.getProperty(a,"Language"))+" - "+lucid.i18nDate.specifiedFormat(e,d,lucid.plugin.getProperty(a,"Language")))):lucid.plugin.setProperty(a,"dateText","",!0)}lucid.plugin.addBlockTextArea(a,{id:"IntervalText",value:i18n.get("plugin-timeline-shape-interval-defaulttext"),
align:"center",vAlign:"bottom",getBoundingBox:function(a){return{x:a.x,y:a.y,w:a.w,h:a.h/2}}});lucid.plugin.addBlockTextArea(a,{id:"dateText",value:"",align:"center",vAlign:"top",readOnly:!0,getBoundingBox:function(a){return{x:a.x,y:a.y+a.h/2,w:a.w,h:a.h/2}}});lucid.plugin.registerProperty(a,"Language",i18n.getLanguage(),null,function(){lucid.plugin.proxyPropertyChanged(a,"languageProxy")});B(a,"StartDate",function(b,d){var c=new Date(lucid.plugin.getProperty(a,"FinishDate"));d=new Date(lucid.plugin.getProperty(d,
"StartDate"));return!Z(b)||0>b-d||0>=c-b?new Date(lucid.plugin.getProperty(a,"StartDate")):b});B(a,"FinishDate",function(b,d){var c=new Date(lucid.plugin.getProperty(a,"StartDate"));d=new Date(lucid.plugin.getProperty(d,"FinishDate"));if(!Z(b)||0>d-b||0>=b-c)b=new Date(lucid.plugin.getProperty(a,"FinishDate"));return b});C(a);lucid.plugin.registerProperty(a,"DateFormat","M/D",function(b){return"string"===typeof b?b:lucid.plugin.getProperty(a,"DateFormat")});D(a,!1);lucid.plugin.hookPropertyPostSave(a,
"StartDate",b);lucid.plugin.hookPropertyPostSave(a,"FinishDate",b);lucid.plugin.hookPropertyPostSave(a,"DateFormat",b);lucid.plugin.hookPropertyPostSave(a,"Language",function(){var c=lucid.plugin.getProperty(a,"Language");lucid.plugin.setProperty(a,"languageText",c,!0);b();lucid.plugin.proxyPropertyChanged(a,"DateFormatOptions")});lucid.plugin.registerProxyProperty(a,"languageProxy",function(){},function(){lucid.plugin.setPropertyIfChanged(a,"Language")})},getRenderData:function(a){var b=a.BoundingBox;
return[{StrokeColor:a.LineColor,LineWidth:a.LineWidth,FillColor:a.FillColor,NoRounding:!0,Actions:V(b.x,b.y,b.w,b.h)}]},beforeDelete:function(a){lucid.plugin.setPropertyIfChanged(a,"TimelineBlockId","")}});lucid.plugin.createToolGroups({Timeline:{displayName:i18n.get("plugin-timeline-group"),items:[{className:"TimelineBlock",variant:"BlockTimeline"},{className:"TimelineBlock",variant:"LineTimeline"},"TimelineMilestoneBlock","TimelineIntervalBlock"]}});
//# sourceMappingURL=/js/plugins/v2/source-maps/timeline.js.map

};

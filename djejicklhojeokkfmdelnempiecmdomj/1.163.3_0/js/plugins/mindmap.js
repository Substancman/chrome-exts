pluginFn['/js/plugins/v2/mindmap.js'] = function(lucid, window) {
	var n={layout:{}};n.layout.TreeHotKeys=function(b){var a=this;this.selectedNode=null;lucid.plugin.onSelectionChange(function(c){1==c.length&&b(c[0])?(a.selectedNode=c[0],lucid.hotKeys.enable()):(a.selectedNode=null,lucid.hotKeys.disable())})};n.layout.TreeHotKeys.prototype.initAddChild=function(b){var a=this;lucid.hotKeys.add(["tab"],function(){a.selectedNode&&(lucid.text.isEditorActive()?lucid.text.blurEditor():b(a.selectedNode))})};
n.layout.TreeHotKeys.prototype.initAddSibling=function(b){var a=this;lucid.hotKeys.add(["enter"],function(){a.selectedNode&&(lucid.text.isEditorActive()?lucid.text.blurEditor():b(a.selectedNode))})};n.layout.TreeHotKeys.prototype.initMoveUp=function(b){var a=this;lucid.hotKeys.add(["up"],function(){a.selectedNode&&(lucid.text.isEditorActive()&&lucid.text.blurEditor(),b(a.selectedNode))})};
n.layout.TreeHotKeys.prototype.initMoveDown=function(b){var a=this;lucid.hotKeys.add(["down"],function(){a.selectedNode&&(lucid.text.isEditorActive()&&lucid.text.blurEditor(),b(a.selectedNode))})};n.layout.TreeHotKeys.prototype.initMoveRight=function(b){var a=this;lucid.hotKeys.add(["right"],function(){a.selectedNode&&(lucid.text.isEditorActive()&&lucid.text.blurEditor(),b(a.selectedNode))})};
n.layout.TreeHotKeys.prototype.initMoveLeft=function(b){var a=this;lucid.hotKeys.add(["left"],function(){a.selectedNode&&(lucid.text.isEditorActive()&&lucid.text.blurEditor(),b(a.selectedNode))})};n.layout.TreeHotKeys.prototype.getSelected=function(){return this.selectedNode};n.mindmap={};var p=null,r,u=!1;
lucid.plugin.onDocumentLoaded(function(){function b(a,b){g&&!b.nospace&&a.spacer();g=!0;"colorwell"==b.type?(a.addGrid({width:6,content:{text:b.name,classes:"crop ralign"}}),a.openGrid({width:3,suffix:3}),a.addInput({type:"colorwell",value:b.value,onChange:b.onChange,size:"fullwidth"}),a.close()):"button"==b.type&&(a.openGrid({width:6,prefix:3,suffix:3}),a.addButton({onClick:function(){b.onClick(b.id)},label:b.text}),a.close())}function a(a,c,e){function d(a,b){!b&&(b=v(lucid.array.filter(lucid.plugin.getSelectionDetails(),
function(a){return a.isBlock})[0].id))&&(lucid.plugin.setPropertyIfChanged(b,"FillColor",a),lucid.plugin.setPropertyIfChanged(b,"LineColor","#000000"))}function h(a,b){b||(r=e,b=w(),b[e-1]=a,p=null,lucid.plugin.setProperty(null,"MindMapColors",b))}b(a,{type:"colorwell",name:0==e?i18n.get("plugin-mindmapping-root-color"):i18n.get("plugin-mindmapping-level-color",{level:e}),value:c,onChange:0==e?d:h})}function c(){if(!m){m=!0;f=lucid.template.builder();var c=w(),h=lucid.array.filter(lucid.plugin.getSelectionDetails(),
function(a){return a.isBlock});if(0<h.length){var q=v(h[0].id);q=lucid.plugin.getProperty(q,"FillColor");a(f,q,0)}lucid.array.forEach(c,function(b,c){a(f,b,c+1)});b(f,{onClick:function(){h[0].id in x&&y(h[0].id)},text:i18n.get("plugin-mindmapping-auto-layout"),type:"button"});e.getElement(d).setContent(f);f.refreshInputs();m=!1;return f}}var e=lucid.template.builder(),d=e.add(),g=!1,f,m=!1;lucid.plugin.addCustomPanel("",null,[{content:e}],null,{isContextPanel:!0,checkShow:function(a){if(lucid.useragent.is_touch())return!1;
a=lucid.array.filter(a,function(a){return a.isBlock});a=0<a.length&&lucid.array.every(a,function(a){return a.id in x});g=!1;a&&c();return a&&function(){f&&f.refreshInputs&&f.refreshInputs()}}});lucid.plugin.hookPropertyPostSave(null,"ColorTheme",function(){p=lucid.plugin.getDocumentColorTheme();lucid.plugin.setProperty(null,"MindMapColors",p);z=!0;c()});lucid.plugin.suspendUndoHistory(function(){var a=[];lucid.plugin.getAllBlockIds().forEach(function(b){A(b)&&(lucid.plugin.getProperty(b,"NoLighten")||
a.push(b))});if(0<a.length){for(var b=w(),c=0;c<b.length;c++)b[c]=lucid.color.lighten(b[c],.5);lucid.plugin.setProperty(null,"MindMapColors",b);a.forEach(function(a){lucid.plugin.setProperty(a,"NoLighten",!0)})}});u=!0});function B(b,a,c,e,d){this.parent=b;this.id=a;this.x=c;this.y=e;this.origX=c;this.origY=e;this.size=d;this.children=[];this.layers=this.leaves=0;this.layer=1;b&&b.children.push(this)}
B.prototype.addChild=function(b,a){if(b.parent!=this){b.parent=this;(this.parent||this).cacheSpringSizes();this.updateLeaves();this.layers=Math.ceil(Math.sqrt(.25+2*Math.ceil(this.leaves/6))-.5);this.children.push(b);this.updateLeaves();var c=Math.ceil(Math.sqrt(.25+2*Math.ceil(this.leaves/6))-.5);this.layers==c&&(this.pin=!0);this.parent&&(this.parent.pin=!0);this.layers=c;b.layer=this.layers;(this.parent||this).applyNewSpringSizeOffset(!!a)}};
B.prototype.cacheSpringSizes=function(){this.cachedSpringSize=this.actualSpringSize();for(var b=0;b<this.children.length;b++)this.children[b].cacheSpringSizes()};
B.prototype.applyNewSpringSizeOffset=function(b,a,c){var e=0,d=0;this.cachedSpringSize&&this.cachedSpringSize.dist&&(e=this.minSpringSize()/this.cachedSpringSize.dist,b||(e=Math.max(1,e)),d=e-1,e=d*this.cachedSpringSize.dx+(a||0),d=d*this.cachedSpringSize.dy+(c||0),this.x+=e,this.y+=d);for(a=0;a<this.children.length;a++)this.children[a].applyNewSpringSizeOffset(!!b,e,d)};B.prototype.updateLeaves=function(){for(var b=this.leaves=0;b<this.children.length;b++)this.children[b].isLeaf()&&this.leaves++};
B.prototype.ancestorPinned=function(){for(var b=this.parent;b;){if(b.pin)return!0;b=b.parent}return!1};B.prototype.isLeaf=function(){return 0==this.children.length};B.prototype.getRadius=function(){for(var b,a,c=0,e=0,d=0;d<this.children.length;d++)b=this.children[d],a=b.getRadius(),c+=a,b.isLeaf()&&(e=Math.max(a,e));c&&(c/=6*Math.ceil(this.children.length/6));return Math.max(Math.max(this.size,e)+2*this.layers*e,c)};
B.prototype.minSpringSize=function(){if(!this.parent)return 0;if(this.isLeaf())return this.parent.size+this.size*(2*this.layer-1)+10;var b=this.getRadius();this.updateLeaves();this.leaves==this.children.length&&(3>=this.leaves?b*=.33:5>=this.leaves&&(b*=.67));return this.parent.getRadius()+b+10};B.prototype.actualSpringSize=function(){if(!this.parent)return{dx:0,dy:0,dist:0};var b=this.x-this.parent.x,a=this.y-this.parent.y;return{dx:b,dy:a,dist:Math.sqrt(b*b+a*a)}};
B.prototype.countDescendants=function(b,a){if(null!=this.descendants&&!b)return this.descendants;a=a||{};for(var c=0,e=0;e<this.children.length;e++){var d=this.children[e];if(a[d.id])break;c++;c+=d.countDescendants(!!b,a)}return this.descendants=c};
B.prototype.sortChildren=function(){for(var b=0;b<this.children.length;b++)this.children[b].countDescendants();this.children.sort(function(a,b){return a.descendants-b.descendants});if(null==this.parent){b=[];for(var a=!0;0<this.children.length;)a?b.push(this.children.pop()):b.push(this.children.shift()),a=!a;this.children=b}};function A(b){b=lucid.plugin.getBlockClassName(b);return null==b?!1:0===b.indexOf("MindMap")}var D=!0;
lucid.plugin.onDocumentLoaded(function(){D=!1;lucid.array.forEach(lucid.plugin.getChildren(),function(b){A(b)&&lucid.array.forEach(lucid.plugin.getConnectedLines(b),function(a){"diagonal"==lucid.plugin.getProperty(a,"Shape")&&lucid.plugin.setPropertyIfChanged(a,"IgnoreTheme",{LineWidth:!0,LineColor:!0,Inset:!0,Shape:!0,Endpoint1:!0,Endpoint2:!0})})});lucid.plugin.inReadOnlyMode()||setTimeout(function(){for(var b=lucid.plugin.getChildren(),a=0,c=b.length;a<c;a++)if(A(b[a])){b=v(b[a]);lucid.plugin.deselectAllItems();
lucid.plugin.selectItem(b);lucid.plugin.showRect(lucid.math.Box.pad(lucid.plugin.getProperty(b,"BoundingBox"),1E3));break}},1E3)});var E={},x={};function F(b){for(var a=[],c=lucid.plugin.getIncomingLines(b),e=0;e<c.length;e++){var d=lucid.plugin.getProperty(c[e],"Endpoint1");d&&d.Block&&d.Block!=b&&a.push(d.Block)}return a}
function G(b){for(var a=[],c=lucid.plugin.getOutgoingLines(b),e=0;e<c.length;e++){var d=lucid.plugin.getProperty(c[e],"Endpoint2");d&&d.Block&&d.Block!=b&&a.push(d.Block)}return a}function H(b,a){if(b in E)return E[b];null==a&&(a=[]);a=a.concat(b);var c=F(b);if(0==c.length)var e=0;else{e=Number.MAX_VALUE;for(var d=0;d<c.length;d++){var g=c[d];lucid.array.contains(a,g)||(e=Math.min(e,H(g,a)+1))}e==Number.MAX_VALUE&&(e=0)}return E[b]=e}
function v(b){for(var a=b,c=H(b),e=F(b);0<c&&0<e.length;){for(var d=0;d<e.length;d++){var g=e[d],f=H(g);f<c&&(a=g,c=f,e=F(g));if(0==c)break}c==H(b)&&(c=0)}return a}function I(b){var a=w();return a[(b-1)%a.length]}var J={};function K(b,a,c){var e=(b+.9|0)+"x"+(a+.9|0);J[e]||(J[e]=Math.sqrt(b*b+a*a)/2);return J[e]+c}
function L(){if(!D){E={};var b={},a;for(a in x)if(lucid.plugin.isBlock(a)&&A(a)){b[a]=!0;var c=a,e=H(c);lucid.plugin.setPropertyIfChanged(c,"LineWidth",e?2:4);var d=0==e||lucid.plugin.getProperty(c,"NonStandardColor")?lucid.plugin.getProperty(c,"FillColor"):I(e);lucid.plugin.setPropertyIfChanged(c,"FillColor",d);lucid.plugin.setPropertyIfChanged(c,"LineColor",e?lucid.color.darken(d,.5):"#000000")}x=b}}
lucid.plugin.onBlockReplaced(function(b){A(b)&&lucid.plugin.getConnectedLines(b).forEach(function(a){lucid.plugin.setPropertyIfChanged(a,"AutoLink",!0);lucid.plugin.setProperty(b,"BoundingBox",lucid.plugin.getProperty(b,"BoundingBox"))})});var z=!1;
lucid.plugin.onAction(function(b){b.Action!=lucid.ActionType.SetProperty||"Endpoint1"!=b.Property&&"Endpoint2"!=b.Property?b.Action==lucid.ActionType.CreateBlock||b.Action==lucid.ActionType.CreateLine?z=!0:b.Action==lucid.ActionType.RemoveBlock||b.Action==lucid.ActionType.RemoveLine||b.Action==lucid.ActionType.RemoveGroup?z=!0:b.Action==lucid.ActionType.SetProperty&&"MindMapColors"==b.Property&&(z="setColors"):z=!0});
lucid.plugin.afterCurrentUserNewAction(function(){if(z){L();if("setColors"==z){var b=lucid.plugin.getAllBlockIds(function(a){return A(a)&&lucid.plugin.getProperty(a,"NonStandardColor")&&H(a)%w().length==r});if(0<b.length){var a=[i18n.get("confirm-yes"),i18n.get("confirm-no")],c=i18n.get("plugin-mindmapping-non-standard-color-blocks",{count:b.length});lucid.dialog.confirm(c,function(){b.forEach(function(a){lucid.plugin.setProperty(a,"NonStandardColor",!1)});L();return!0},function(){},a)}}z=!1}});
function M(b,a,c){function e(a,c){if(!g[a]){g[a]=!0;var h=lucid.plugin.getProperty(a,"BoundingBox"),C=h.x+h.w/2,f=h.y+h.h/2,k=G(a);c=new B(c,a,C,f,K(h.w,h.h,10));d.push(c);a==b&&(m=c);for(a=0;a<k.length;a++)e(k[a],c)}}var d=[],g={},f=v(b),m;e(f,null);m&&a&&a(m);c&&c(g);return d}
function N(b,a,c,e,d,g){var f=a.parent?Math.atan2(a.y-a.parent.y,a.x-a.parent.x)+(a.children.length%2*2-1)*(d?.25*(1-(a.children.length+1)/d):.3333333333*((a.children.length+1)/2|0))*Math.PI:(d?a.children.length/d*360:a.children.length%6*60)*Math.PI/180;f+=10*(a.children.length/6|0)*Math.PI/180;d=Math.cos(f);f=Math.sin(f);c=new B(null,c,0,0,e);a.addChild(c,!!g);g=c.minSpringSize();c.x=a.x+d*g;c.y=a.y+f*g;c.origX=c.x;c.origY=c.y;b.push(c);return c}
function O(b){for(var a=[],c=[],e=0;e<b.length;e++){var d=b[e];a.push({id:d.id,x:d.x,y:d.y,origX:d.origX,origY:d.origY,r:d.size,pin:!(null!=d.parent&&!d.pin)});if(d.parent){var g=d.x-d.parent.x,f=d.y-d.parent.y;c.push({id1:d.parent.id,id2:d.id,length:Math.sqrt(g*g+f*f)})}}return{circles:a,springs:c}}
function y(b){function a(b,c){m[c]||(m[c]=[]);for(var d=0;d<b.children.length;d++){var e=b.children[d];m[c].push(e);a(e,c+1)}}function c(a,b){var c=O(g),d=c.springs;c=c.circles;lucid.physics.createWorldAndSettle(c,d,a,function(a){for(var c=g,d=0;d<a.length;d++){var e=a[d],h=c[d];if(!h||e.id!=h.id)break;h.x=e.newX;h.y=e.newY}b&&b(a)})}var e=M(b);if(!(1>e.length)){var d=e[0],g=[new B(null,d.id,d.x,d.y,d.size)];b={};b[d.id]=g[0];for(var f=0;f<e.length;f++)0==f&&e[f].countDescendants(!0),e[f].sortChildren();
var m=[];a(d,0);for(e=0;e<m.length;e++)for(d=m[e],f=0;f<d.length;f++){var l=d[f],h=b[l.parent.id];if(!h)break;b[l.id]=N(g,h,l.id,l.size,l.parent.children.length,!0);c(2)}c(5,function(a){function b(a,b,c,e,d){var h=Math.min(((b.x>c.x?a.x:a.x+a.w)-b.x)/(c.x-b.x),((b.y>c.y?a.y:a.y+a.h)-b.y)/(c.y-b.y)),f=lucid.plugin.getProperty(e,d);f.LinkX=(b.x+h*(c.x-b.x)-a.x)/a.w;f.LinkY=(b.y+h*(c.y-b.y)-a.y)/a.h;lucid.plugin.setProperty(e,d,f)}function c(a,b){return lucid.plugin.getProperty(lucid.plugin.getProperty(a,
b).Block,"BoundingBox")}function d(a){return a.Block&&0==lucid.plugin.getBlockClassName(a.Block).indexOf("MindMap")}for(var e,h=0;h<a.length;h++){var f=a[h];lucid.plugin.getConnectedLines(f.id).forEach(function(a){lucid.plugin.resetLine(a)});if(!lucid.plugin.getProperty(f.id,"Lock")){e=lucid.plugin.getProperty(f.id,"BoundingBox");if(!e)break;var g=f.newX-(e.x+e.w/2),q=f.newY-(e.y+e.h/2);25<g*g+q*q&&(e=lucid.plugin.getProperty(f.id,"BoundingBox"),lucid.plugin.setPropertyIfChanged(f.id,"BoundingBox",
{x:Math.round(e.x+g),y:Math.round(e.y+q),w:Math.round(e.w),h:Math.round(e.h)}))}}a.reduce(function(a,b){return a.concat(lucid.plugin.getConnectedLines(b.id).filter(function(b){return 0<=a.indexOf(b)?!1:d(lucid.plugin.getProperty(b,"Endpoint1"))&&d(lucid.plugin.getProperty(b,"Endpoint2"))}))},[]).forEach(function(a){var e=c(a,"Endpoint1"),d=c(a,"Endpoint2"),h=lucid.math.Box.center(e),f=lucid.math.Box.center(d);0<lucid.math.Point.distance(h,f)&&(b(e,h,f,a,"Endpoint1"),b(d,f,h,a,"Endpoint2"))})})}}
function P(b){var a=Q[lucid.plugin.getBlockClassName(b)].defaultSize,c,e={},d=K(a.w,a.h,10),g="__temp__",f=M(b,function(a){c=a},function(a){e=a});if(c){for(;e[g];)g+=Math.round(10*Math.random());N(f,c,g,d);d=O(f);f=d.springs;d=d.circles;var m;d=lucid.physics.createWorldAndSettle(d,f,null,function(c){lucid.plugin.getProperty(b,"HideChildren")&&S(b);for(var e=lucid.plugin.getItemPageId(b),d=0;d<c.length;d++){var f=c[d];if(f.id==g){f={x:f.newX-a.w/2,y:f.newY-a.h/2,w:a.w,h:a.h};m=lucid.plugin.addBlock(e,
{className:lucid.plugin.getBlockClassName(b),BoundingBox:f,Text:"New Idea",NoLighten:!0});var l=lucid.plugin.getProperty(b,"BoundingBox");lucid.plugin.addLine(e,{Shape:"diagonal",IgnoreTheme:{LineWidth:!0,LineColor:!0,Inset:!0,Shape:!0,Endpoint1:!0,Endpoint2:!0},AutoLink:!0,LineWidth:2,LineColor:"#000000",Endpoint1:{Block:b,LinkX:.5,LinkY:.5,x:l.x+l.w/2,y:l.y+l.h/2,Style:"None"},Endpoint2:{Block:m,LinkX:.5,LinkY:.5,x:f.x+f.w/2,y:f.y+f.h/2,Style:"None"}});lucid.plugin.setProperty(m,"BoundingBox",f)}else if(!lucid.plugin.getProperty(f.id,
"Lock")){l=f.newX-f.origX;var k=f.newY-f.origY;if(25<l*l+k*k){var t=lucid.plugin.getProperty(f.id,"BoundingBox");lucid.plugin.setPropertyIfChanged(f.id,"BoundingBox",{x:Math.round(t.x+l),y:Math.round(t.y+k),w:Math.round(t.w),h:Math.round(t.h)})}}}lucid.plugin.deselectAllItems();lucid.plugin.selectItem(m);lucid.plugin.editBlockTextArea(m,"Text")});return m}}function T(b,a){var c=2*Math.PI;b=(a+c)%c-(b+c)%c;return b>Math.PI?b-c:b<-Math.PI?b+c:b}
function U(b){var a=F(b);if(0==a.length)return null;b=lucid.math.Box.center(lucid.plugin.getProperty(b,"BoundingBox"));a=lucid.math.Box.center(lucid.plugin.getProperty(a[0],"BoundingBox"));return Math.atan2(b.y-a.y,b.x-a.x)}
function V(b){var a=G(b),c=U(b)||0,e=lucid.math.Box.center(lucid.plugin.getProperty(b,"BoundingBox")),d=[];lucid.array.forEach(a,function(a){var b=lucid.math.Box.center(lucid.plugin.getProperty(a,"BoundingBox"));b=T(Math.atan2(b.y-e.y,b.x-e.x),c);d.push({id:a,theta:b})});d.sort(function(a,b){return a.theta-b.theta});return d}function aa(b){b=F(b);0<b.length&&(lucid.plugin.deselectAllItems(),lucid.plugin.selectItem(b[0]),lucid.plugin.showRect(lucid.plugin.getProperty(b[0],"BoundingBox")))}
function ba(b,a){if(!lucid.plugin.getProperty(b,"HideChildren")){b=V(b);var c=1E4,e=null;a=a||0;for(var d=0,g=b.length;d<g;d++){var f=Math.abs(T(b[d].theta,a));f<c&&(c=f,e=b[d].id)}e&&(lucid.plugin.deselectAllItems(),lucid.plugin.selectItem(e),lucid.plugin.showRect(lucid.plugin.getProperty(e,"BoundingBox")))}}
function ca(b,a){var c=F(b);if(0!=c.length){c=V(c[0]);for(var e=0,d=c.length;e<d;e++)if(c[e].id==b){b=(e+d+a)%d;lucid.plugin.deselectAllItems();lucid.plugin.selectItem(c[b].id);lucid.plugin.showRect(lucid.plugin.getProperty(c[b].id,"BoundingBox"));break}}}function da(b){var a=G(b);b=lucid.plugin.getOutgoingLines(b);lucid.array.forEach(b,function(a){lucid.plugin.setProperty(a,"Hidden",!0)});lucid.array.forEach(a,function(a){lucid.plugin.setProperty(a,"Hidden",!0);da(a)})}
function ea(b){lucid.plugin.setProperty(b,"Hidden",!1);if(!lucid.plugin.getProperty(b,"HideChildren")){var a=lucid.plugin.getOutgoingLines(b);lucid.array.forEach(a,function(a){lucid.plugin.setProperty(a,"Hidden",!1)});b=G(b);lucid.array.forEach(b,function(a){ea(a)})}}function S(b){var a=!lucid.plugin.getProperty(b,"HideChildren");lucid.plugin.setProperty(b,"HideChildren",a);a?da(b):ea(b)}var Q={};function W(){return lucid.plugin.getProperty(null,"Version")||0}
function X(b){Q[b.className]=b;lucid.plugin.initBlockClass({className:b.className,name:b.name,searchKeywords:b.searchKeywords,defaultSize:b.defaultSize,getLinkPoints:b.getLinkPoints,allowHiding:!0,onInit:function(a){function c(c){return 1<W()?{x:c.x,y:c.y,w:c.w,h:c.h,fitShape:lucid.plugin.getProperty(a,"InsetMargin")||0,hideOverflow:!0}:b.getTextBoundingBox(c)}function e(){function b(){if(1<W())return!lucid.text.hasOverflowText(a,"Text",!0);l=c(k);m=lucid.text.getSize(a,"Text",l);return!(m.w>=l.w||
m.h>=l.h)}var e=lucid.plugin.getProperty(a,"BoundingBox");if(e){var l=c(e),m=lucid.text.getSize(a,"Text",l),k={x:e.x,y:e.y,w:e.w,h:e.h};k.w=Math.max(d,k.w);k.h=Math.max(g,k.h);if(2>W())for(;!b();)k.w*=1.1,k.h*=1.1;else b()||(k.w*=1.1,k.h*=1.1);if(!lucid.plugin.getProperty(a,"HasBeenUserResized")&&2>W()){for(var t=k;k.w>d&&k.h>g&&b();)if(t=lucid.object.clone(k),k.w*=f,k.h*=f,k.w<d||k.h<g){var R=k.w/d<=k.h/g?d/t.w:g/t.h;k.w=t.w*R;k.h=t.h*R}k=t}if(e.w!=k.w||e.h!=k.h)k.x-=.5*(k.w-e.w),k.y-=.5*(k.h-e.h),
lucid.plugin.setPropertyIfChanged(a,"HasBeenUserResized",!1),lucid.plugin.setProperty(a,"BoundingBox",k)}}x[a]=!0;lucid.plugin.registerProperty(a,"HideChildren",!1);lucid.plugin.setProperty(a,"TextVAlign","middle");lucid.plugin.addBlockTextArea(a,{id:"Text",value:i18n.get("plugin-mindmapping-default-text"),getBoundingBox:c});var d=b.defaultSize.w,g=b.defaultSize.h,f=1/1.1,m,l=i18n.get("plugin-mindmapping-default-text");lucid.plugin.hookPropertyPostSave(a,"Text",function(a,b){lucid.text.isEditorActive()&&
b.t!==l&&!m&&(m=setTimeout(function(){e(a,b);m=null},0),l=b.t)});lucid.plugin.hookPropertyPostSave(a,"FillColor",function(b,c){u&&(b=H(a),0!=b&&(b=I(b),c!=b?lucid.plugin.setPropertyIfChanged(a,"NonStandardColor",!0):lucid.plugin.setPropertyIfChanged(a,"NonStandardColor",!1),lucid.plugin.setPropertyIfChanged(a,"LineColor",lucid.color.darken(c,.5))))});1<W()&&(lucid.plugin.registerProperty(a,"TextWrap","fit"),lucid.plugin.registerProperty(a,"InsetMargin",5));if(b.onInit)b.onInit(a)},onCreate:function(a){lucid.plugin.editBlockTextArea(a,
"Text");lucid.plugin.setProperty(a,"NoLighten",!0)},getRenderData:function(a,c){var e=b.getRenderData(a,c),d=a.BoundingBox;(a.HideChildren||"hover"==c)&&0<G(a.id).length&&(c=[{Action:"move",x:d.x+d.w-2,y:d.y+d.h-10},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(d.x+d.w-18,d.y+d.h-18,16,16,0,2*Math.PI)},{Action:"close"},{Action:"move",x:d.x+d.w-14,y:d.y+d.h-10},{Action:"line",x:d.x+d.w-6,y:d.y+d.h-10}],a.HideChildren&&(c.push({Action:"move",x:d.x+d.w-10,y:d.y+d.h-14}),c.push({Action:"line",
x:d.x+d.w-10,y:d.y+d.h-6})),e.push({FillColor:"#FFFFFF",StrokeColor:"#333333",LineWidth:1,Actions:c}));return e},hitTest:function(a,b){var c=lucid.plugin.getProperty(a,"BoundingBox");if(c&&(b=lucid.math.Point.rotate(b,lucid.math.Box.center(c),-lucid.plugin.getProperty(a,"Rotation")),0!=G(a).length&&lucid.math.Box.pointInBox(b,{x:c.x+c.w-20,y:c.y+c.h-20,w:20,h:20})))return{onClick:function(){S(a)},cursor:"pointer"}},disabledPropertyControls:["FillType","LineWidth","LineColor"],vLock:!1,hLock:!1,renderOnHover:!0,
getOffsetProperties:function(a,b,e){var c={};if(0==e.w&&0==e.h){var g=lucid.plugin.getDownstream(a,function(b){return b==a||!lucid.plugin.isSelected(b)});b=b||lucid.plugin.getProperty(a,"BoundingBox");for(var f=0;f<g.length;f++){var m=g[f];c[m]=lucid.plugin.defaultOffsetProperties(m,b,e)[m]}}else return lucid.plugin.setPropertyIfChanged(a,"HasBeenUserResized",!0),lucid.plugin.defaultOffsetProperties(a,b,e);return c},onDelete:function(a){D=!0;null==a&&aa(a);lucid.array.forEach(lucid.plugin.getOutgoingLines(a),
function(b){var c=lucid.plugin.getProperty(b,"Endpoint2");c.Block&&c.Block!=a&&A(c.Block)&&(lucid.plugin.deleteItem(c.Block),lucid.plugin.deleteItem(b))});lucid.array.forEach(lucid.plugin.getIncomingLines(a),function(a){lucid.plugin.deleteItem(a)});D=!1},lineDrawnProperties:function(){return{Shape:"diagonal",AutoLink:!0,IgnoreTheme:{LineWidth:!0,LineColor:!0,Inset:!0,Shape:!0,Endpoint1:!0,Endpoint2:!0},LineColor:"#000000",LineWidth:2,Inset:0,Endpoint1:{Style:"None"},Endpoint2:{Style:"None"}}}})}
X({className:"MindMapBlock",name:i18n.get("plugin-mindmapping-shapes-rectangle"),searchKeywords:"",defaultSize:{w:116,h:42},getTextBoundingBox:function(b){return{x:b.x+10,y:b.y+10,w:b.w-20,h:b.h-20}},getLinkPoints:function(){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},onInit:function(b){lucid.plugin.setProperty(b,"Rounding",10)},getRenderData:function(b){var a=b.BoundingBox;return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:a.y},{Action:"line",
x:a.x+a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+a.h},{Action:"close"}]}]}});
X({className:"MindMapCircle",name:i18n.get("plugin-mindmapping-shapes-circle"),searchKeywords:"",defaultSize:{w:120,h:120},getTextBoundingBox:function(b){return{x:b.x+.18*b.w,y:b.y+.18*b.h,w:.64*b.w,h:.64*b.h}},getLinkPoints:function(){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderData:function(b){var a=b.BoundingBox;return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+a.w,y:a.y+a.h/2},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x,
a.y,a.w,a.h,0,2*Math.PI)},{Action:"close"}]}]}});
X({className:"MindMapDiamondBlock",name:i18n.get("plugin-mindmapping-shapes-diamond"),searchKeywords:"",defaultSize:{w:160,h:120},getTextBoundingBox:function(b){return{x:b.x+.25*b.w,y:b.y+.25*b.h,w:.5*b.w,h:.5*b.h}},getLinkPoints:function(){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderData:function(b){var a=b.BoundingBox,c=a.x+a.w/2,e=a.y+a.h/2;return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:c,y:a.y},{Action:"line",x:a.x+a.w,y:e},
{Action:"line",x:c,y:a.y+a.h},{Action:"line",x:a.x,y:e},{Action:"close"}]}]}});
X({className:"MindMapIsoscelesTriangleBlock",name:i18n.get("plugin-mindmapping-shapes-triangle"),searchKeywords:i18n.get("plugin-mindmapping-shapes-triangle-keywords"),defaultSize:{w:140,h:120},getTextBoundingBox:function(b){return{x:b.x+.25*b.w,y:b.y+.5*b.h,w:.5*b.w,h:.4*b.h}},getLinkPoints:function(){return[{x:.5,y:0},{x:.25,y:.5},{x:.5,y:1},{x:.75,y:.5}]},getRenderData:function(b){var a=b.BoundingBox;return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",
x:a.x,y:a.y+a.h},{Action:"line",x:a.x+a.w,y:a.y+a.h},{Action:"line",x:a.x+a.w/2,y:a.y},{Action:"close"}]}]}});
X({className:"MindMapOctagonBlock",name:i18n.get("plugin-mindmapping-shapes-octagon"),searchKeywords:"",defaultSize:{w:120,h:120},getTextBoundingBox:function(b){return{x:b.x+.145*b.w,y:b.y+.145*b.h,w:.71*b.w,h:.71*b.h}},getLinkPoints:function(){return[{x:.145,y:.145},{x:.5,y:0},{x:.855,y:.145},{x:1,y:.5},{x:.855,y:.855},{x:.5,y:1},{x:.145,y:.855},{x:0,y:.5}]},getRenderData:function(b){var a=b.BoundingBox;return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",
x:a.x,y:a.y+.29*a.h},{Action:"line",x:a.x+.29*a.w,y:a.y},{Action:"line",x:a.x+.71*a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+.29*a.h},{Action:"line",x:a.x+a.w,y:a.y+.71*a.h},{Action:"line",x:a.x+.71*a.w,y:a.y+a.h},{Action:"line",x:a.x+.29*a.w,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+.71*a.h},{Action:"close"}]}]}});
X({className:"MindMapCloud",name:i18n.get("plugin-mindmapping-shapes-cloud"),searchKeywords:"",defaultSize:{w:133,h:100},getTextBoundingBox:function(b){return{x:b.x+.18*b.w,y:b.y+.18*b.h,w:.72*b.w,h:.64*b.h}},getLinkPoints:function(){return[{x:0,y:.5},{x:.24,y:.07},{x:.6,y:.01},{x:.97,y:.3},{x:.955,y:.85},{x:.6,y:1},{x:.25,y:.925}]},getRenderData:function(b){var a=b.BoundingBox;return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+.15*a.w,y:a.y+
.7*a.h},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x,a.y+.3*a.h,.3*a.w,.4*a.h,.5*Math.PI,1.4*Math.PI)},{Action:"curve",Control:[{x1:a.x+.1*a.w,y1:a.y+.05*a.h,x2:a.x+.35*a.w,y2:a.y+0*a.h,x3:a.x+.45*a.w,y3:a.y+.1*a.h},{x1:a.x+.5*a.w,y1:a.y+-.05*a.h,x2:a.x+.75*a.w,y2:a.y+0*a.h,x3:a.x+.75*a.w,y3:a.y+.15*a.h},{x1:a.x+.9*a.w,y1:a.y+.1*a.h,x2:a.x+1.05*a.w,y2:a.y+.3*a.h,x3:a.x+.95*a.w,y3:a.y+.55*a.h},{x1:a.x+1.05*a.w,y1:a.y+.75*a.h,x2:a.x+.95*a.w,y2:a.y+1*a.h,x3:a.x+.75*a.w,y3:a.y+.9*a.h},
{x1:a.x+.7*a.w,y1:a.y+1.03*a.h,x2:a.x+.5*a.w,y2:a.y+1.03*a.h,x3:a.x+.45*a.w,y3:a.y+.9*a.h},{x1:a.x+.35*a.w,y1:a.y+1*a.h,x2:a.x+.15*a.w,y2:a.y+.95*a.h,x3:a.x+.15*a.w,y3:a.y+.7*a.h}]},{Action:"close"}]}]}});
X({className:"MindMapPentagonBlock",name:i18n.get("plugin-mindmapping-shapes-pentagon"),searchKeywords:"",defaultSize:{w:126,h:120},getTextBoundingBox:function(b){return{x:b.x+.175*b.w,y:b.y+.25*b.h,w:.65*b.w,h:.62*b.h}},getLinkPoints:function(){return[{x:0,y:.382},{x:.25,y:.191},{x:.5,y:0},{x:.75,y:.191},{x:1,y:.382},{x:.9045,y:.691},{x:.809,y:1},{x:.5,y:1},{x:.191,y:1},{x:.0955,y:.691}]},getRenderData:function(b){var a=b.BoundingBox;return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,
Actions:[{Action:"move",x:a.x,y:a.y+.382*a.h},{Action:"line",x:a.x+a.w/2,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+.382*a.h},{Action:"line",x:a.x+.809*a.w,y:a.y+a.h},{Action:"line",x:a.x+.191*a.w,y:a.y+a.h},{Action:"close"}]}]}});
X({className:"MindMapCrossBlock",name:i18n.get("plugin-mindmapping-shapes-cross"),searchKeywords:"",defaultSize:{w:120,h:120},onInit:function(b){lucid.plugin.registerProperty(b,"Indent",{x:.25,y:.25})},getTextBoundingBox:function(b){return{x:b.x+.1*b.w,y:b.y+.25*b.h,w:.8*b.w,h:.5*b.h}},getLinkPoints:function(){return[{x:0,y:.5},{x:.5,y:0},{x:1,y:.5},{x:.5,y:1}]},getRenderData:function(b){var a=b.BoundingBox,c=b.Indent;return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",
x:a.x,y:a.y+a.h*c.y},{Action:"line",x:a.x+a.w*c.x,y:a.y+a.h*c.y},{Action:"line",x:a.x+a.w*c.x,y:a.y},{Action:"line",x:a.x+a.w-a.w*c.x,y:a.y},{Action:"line",x:a.x+a.w-a.w*c.x,y:a.y+a.h*c.y},{Action:"line",x:a.x+a.w,y:a.y+a.h*c.y},{Action:"line",x:a.x+a.w,y:a.y+a.h-a.h*c.y},{Action:"line",x:a.x+a.w-a.w*c.x,y:a.y+a.h-a.h*c.y},{Action:"line",x:a.x+a.w-a.w*c.x,y:a.y+a.h},{Action:"line",x:a.x+a.w*c.x,y:a.y+a.h},{Action:"line",x:a.x+a.w*c.x,y:a.y+a.h-a.h*c.y},{Action:"line",x:a.x,y:a.y+a.h-a.h*c.y},{Action:"close"}]}]}});
X({className:"MindMapHexagonBlock",name:i18n.get("plugin-mindmapping-shapes-hexagon"),searchKeywords:"",defaultSize:{w:140,h:120},getTextBoundingBox:function(b){return{x:b.x+.2*b.w,y:b.y+.1*b.h,w:.6*b.w,h:.8*b.h}},getLinkPoints:function(){return[{x:0,y:.5},{x:.125,y:.25},{x:.25,y:0},{x:.5,y:0},{x:.75,y:0},{x:.875,y:.25},{x:1,y:.5},{x:.875,y:.75},{x:.75,y:1},{x:.5,y:1},{x:.25,y:1},{x:.125,y:.75}]},getRenderData:function(b){var a=b.BoundingBox;return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,
Actions:[{Action:"move",x:a.x,y:a.y+a.h/2},{Action:"line",x:a.x+.25*a.w,y:a.y},{Action:"line",x:a.x+.75*a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+a.h/2},{Action:"line",x:a.x+.75*a.w,y:a.y+a.h},{Action:"line",x:a.x+.25*a.w,y:a.y+a.h},{Action:"close"}]}]}});
X({className:"MindMapStadiumBlock",name:i18n.get("plugin-mindmapping-shapes-pill"),searchKeywords:i18n.get("plugin-mindmapping-shapes-pill-keywords"),defaultSize:{w:160,h:80},getTextBoundingBox:function(b){return{x:b.x+.15*b.w,y:b.y,w:.7*b.w,h:b.h}},getLinkPoints:function(){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderData:function(b){var a=b.BoundingBox;return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+.8*a.w,y:a.y},{Action:"curve",
Control:lucid.math.ellipseArcControlPoints(a.x+.6*a.w,a.y,.4*a.w,a.h,-.5*Math.PI,.5*Math.PI)},{Action:"line",x:a.x+.2*a.w,y:a.y+a.h},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x,a.y,.4*a.w,a.h,.5*Math.PI,1.5*Math.PI)},{Action:"close"}]}]}});function w(){if(p)return p;var b=lucid.plugin.getProperty(null,"MindMapColors");b||(b=["#f78d1eff","#8cbf3fff","#29aae1ff","#a32385ff","#ea0e8bff"],lucid.plugin.setProperty(null,"MindMapColors",b));return b}
function Y(b,a,c){null==a?ba(b,c):(c=(Math.round(180*c/Math.PI)+360)%360,a=(Math.round(180*a/Math.PI)+360+c)%360,45>a||315<=a?ba(b):135>a?ca(b,1):225>a?aa(b):315>a&&ca(b,-1))}var Z=new n.layout.TreeHotKeys(A);Z.initAddChild(P);Z.initAddSibling(function(b){b=F(b);0<b.length&&P(b[0])});Z.initMoveLeft(function(b){var a,c=F(b);0<c.length&&(a=U(c[0]));a||(a=U(b));Y(b,a,Math.PI)});Z.initMoveRight(function(b){var a,c=F(b);0<c.length&&(a=U(c[0]));a||(a=U(b));Y(b,a,0)});
Z.initMoveUp(function(b){var a,c=F(b);0<c.length&&(a=U(c[0]));a||(a=U(b));Y(b,a,Math.PI/2)});Z.initMoveDown(function(b){var a,c=F(b);0<c.length&&(a=U(c[0]));a||(a=U(b));Y(b,a,-Math.PI/2)});lucid.hotKeys.add(["f2"],function(){Z.getSelected()&&lucid.plugin.editBlockTextArea(Z.getSelected(),"Text")});lucid.hotKeys.add(["space"],function(){Z.getSelected()&&lucid.plugin.editBlockTextArea(Z.getSelected(),"Text")});
lucid.hotKeys.add(["z"],function(){Z.getSelected()&&0<G(Z.getSelected()).length&&(lucid.text.isEditorActive()||S(Z.getSelected()))});lucid.plugin.createExchangeGroup("MindMapBlock MindMapStadiumBlock MindMapCloud MindMapCircle MindMapIsoscelesTriangleBlock MindMapDiamondBlock MindMapPentagonBlock MindMapHexagonBlock MindMapOctagonBlock MindMapCrossBlock".split(" "));lucid.plugin.createNextBlockGroup("MindMapBlock MindMapStadiumBlock MindMapCloud MindMapCircle MindMapIsoscelesTriangleBlock MindMapDiamondBlock MindMapPentagonBlock MindMapHexagonBlock MindMapOctagonBlock MindMapCrossBlock".split(" "));
lucid.plugin.onActivate(function(){lucid.physics.init();lucid.plugin.allowShadowSharing("MindMapBlock",!0);lucid.plugin.allowShadowSharing("MindMapStadiumBlock",!0);lucid.plugin.allowShadowSharing("MindMapCloud",!0);lucid.plugin.allowShadowSharing("MindMapCircle",!0);lucid.plugin.allowShadowSharing("MindMapIsoscelesTriangleBlock",!0);lucid.plugin.allowShadowSharing("MindMapDiamondBlock",!0);lucid.plugin.allowShadowSharing("MindMapPentagonBlock",!0);lucid.plugin.allowShadowSharing("MindMapHexagonBlock",
!0);lucid.plugin.allowShadowSharing("MindMapOctagonBlock",!0);lucid.plugin.allowShadowSharing("MindMapCrossBlock",!0)});
lucid.plugin.createToolGroups({"Mind Map":{displayName:i18n.get("plugin-mindmapping-toolgroup-name"),items:["MindMapBlock","MindMapStadiumBlock","MindMapCloud","MindMapCircle","MindMapIsoscelesTriangleBlock","MindMapDiamondBlock","MindMapPentagonBlock","MindMapHexagonBlock","MindMapOctagonBlock","MindMapCrossBlock",{label:i18n.get("plugin-mindmapping-toolgroup-buttons-import"),action:function(){function b(a,b){var c,e=lucid.plugin.getActivePageId(),d,l=[];a.forEach(function(a){for(var f=0,h=0;h<a.length;h++)if(""===
a[h]){for(var g=h;g<a.length;g++)a[g]=a[g+1];h--;a.pop();f++}if(0!==a.length)if(a=a.reduce(function(a,b){return a+" "+b}),0===f){c&&y(c);if(c||0<lucid.plugin.getChildren(e).length)e=lucid.plugin.addPage({Title:a});d||(d=e);c=lucid.plugin.addBlock(e,{className:b,BoundingBox:{x:0,y:0,w:Q[b].defaultSize.w,h:Q[b].defaultSize.h},Text:a});a=lucid.plugin.getPageSize(e);h=lucid.plugin.getProperty(c,"BoundingBox");h.x=a.w/2-h.w/2;h.y=a.h/2-h.h/2;lucid.plugin.setPropertyIfChanged(c,"BoundingBox",h);l.push({id:c,
depth:f})}else{for(;0<l.length&&l[l.length-1].depth>=f;)l.pop();h=P(l[l.length-1].id);g=lucid.text.getStyleFromContent(lucid.plugin.getProperty(h,"Text"));lucid.plugin.setPropertyIfChanged(h,"Text",lucid.text.restyle(a,g));l.push({id:h,depth:f})}});y(c);lucid.plugin.selectPage(d)}function a(a){lucid.CSV.toArrays(a,{separator:" ",delimiter:"\x00"},function(a){a?b(a,c):lucid.dialog.alert(i18n.get("plugin-mindmapping-could-not-parse-data"))})}var c;(function(){var b=lucid.template.builder(),d=null;b.add({text:i18n.get("plugin-mindmapping-step-1-select-data"),
classes:"title bold"});b.open();b.add({tag:"span",text:i18n.get("plugin-mindmapping-step-1-select-txt-file")});b.add({tag:"a",text:i18n.get("plugin-mindmapping-step-1-learn-more"),classes:"link",attr:{href:"http://support.lucidchart.com/entries/21777820-Mind-mapping#importexport",target:"_blank"}});b.close();b.addInput({type:"file",onSuccess:function(a){d=a}});b.add({text:i18n.get("plugin-mindmapping-step-1-or"),classes:"bold space"});b.add({tag:"div",text:i18n.get("plugin-mindmapping-step-1-paste-outline")});
var g=b.open({classes:"text-area blur"}),f=i18n.get("plugin-mindmapping-step-1-outline-example"),m=b.addInput({type:"text",textArea:!0,allowEnter:!0,value:f,onFocus:function(){m.getValue()===f&&(m.setValue(""),b.getElement(g).removeClass("blur"))},onBlur:function(){0===m.getValue().length&&(m.setValue(f),b.getElement(g).addClass("blur"))}});b.close();b.add({text:i18n.get("plugin-mindmapping-step-2-choose-style"),classes:"title bold"});b.add({text:i18n.get("plugin-mindmapping-step-2-choose-default-shape"),
classes:"subtext"});for(var l="MindMapBlock MindMapStadiumBlock MindMapCloud MindMapCircle MindMapIsoscelesTriangleBlock MindMapDiamondBlock MindMapPentagonBlock MindMapHexagonBlock MindMapOctagonBlock MindMapCrossBlock".split(" "),h=[{value:-1,label:i18n.get("plugin-mindmapping-step-2-choose-style-input-placeholder")}],q=0;q<l.length;q++)h.push({value:q,label:Q[l[q]].name});b.open({classes:"select"});b.addInput({type:"select",inDialog:!0,options:h,onChange:function(a){0<=a&&(c=l[a])}});b.close();
var C=lucid.dialog.custom(b.getTemplate(),{title:i18n.get("plugin-mindmapping-import-title"),classes:"mind-map-dialog import",modal:!0,buttons:[{label:i18n.get("plugin-mindmapping-import-cancel"),action:function(){C.close()}},{label:i18n.get("plugin-mindmapping-import-doit"),action:function(){if(d){if(0<m.getValue().length&&!b.getElement(g).hasClass("blur")){lucid.dialog.alert(i18n.get("plugin-mindmapping-import-error-two-outlines"));return}}else if(0===m.getValue().length){lucid.dialog.alert(i18n.get("plugin-mindmapping-import-error-no-data"));
return}c?(C.close(),d||(d=m.getValue()+"\n"),a(d.replace(/\t/g," "))):lucid.dialog.alert(i18n.get("plugin-mindmapping-import-error-no-shape-class"))}}]});C.open()})()}},{label:i18n.get("plugin-mindmapping-toolgroup-buttons-export"),action:function(){function b(a,c,d){var e=a.filter(function(a){return a.parentId===c.id});0<e.length&&(-1===c.id?d=e:c.children=e,e.forEach(function(c){b(a,c,[])}));return d}function a(b,c){for(var d="",e=0;e<b.depth;e++)d+=c;d+=b.text+"\n";b.children&&b.children.forEach(function(b){d+=
a(b,c)});return d}function c(a){for(var b="",d=0;d<a.depth+1;d++)b+="  ";d=b;b+="<li>"+a.text+"</li>\n";a.children&&(b+=d+"<ul>\n",a.children.forEach(function(a){b+=c(a)}),b+=d+"</ul>\n");return b}function e(d){function e(b){var d=lucid.template.builder();if("plainText"===b){d.open({classes:"text-area-container"});var e="";f.forEach(function(b){e+=a(b,"\t")});d.add({tag:"textarea",text:e,classes:"text-area",attr:{readonly:!0}});d.close()}else"bulleted"!==b&&(d.open({classes:"text-area-container"}),
e="",f.forEach(function(a){e+="<ul>\n"+c(a)+"</ul>\n"}),d.add({tag:"textarea",text:e,classes:"text-area",attr:{readonly:!0}}),d.close());l.getElement(k)&&l.getElement(k).setContent(d)}var f=b(d,{id:-1},[]),g="plainText",l=lucid.template.builder();l.add({text:i18n.get("plugin-mindmapping-export-select-formatting")});l.addInput({type:"radio",separator:"&nbsp;",buttons:[{value:0,label:i18n.get("plugin-mindmapping-export-outline-plaintext"),checked:function(){return"plainText"===g}},{value:1,label:i18n.get("plugin-mindmapping-export-outline-html"),
checked:function(){return"HTML"===g}}],onChange:function(a){e(g=0===a?"plainText":"HTML")}});var k=l.open({});l.close();l.spacer();l.add({text:i18n.get("plugin-mindmapping-export-instruction",{combo:lucid.useragent.is_linux()||lucid.useragent.is_win()?"Ctrl+C":"Cmd+C"})});var m=lucid.dialog.custom(l.getTemplate(),{title:i18n.get("plugin-mindmapping-export-title"),classes:"mind-map-dialog export",modal:!0,buttons:[{label:i18n.get("confirm-ok"),action:function(){m.close()}}]});m.open();e(g)}var d={},
g=lucid.plugin.getAllBlockIds().filter(function(a){return lucid.plugin.getItemPageId(a)!==lucid.plugin.getActivePageId()?!1:A(a)?!0:(d.foreignBlock=!0,!1)});if(0===g.length)lucid.dialog.alert(i18n.get("plugin-mindmapping-export-noblocks"));else{var f=[];g.forEach(function(a){var b=F(a);1<b.length&&(d.multiParent=!0);b=b[0];var c=H(a),e=lucid.text.plainText(lucid.plugin.getProperty(a,"Text"));f.push({id:a,parentId:b?b:-1,depth:c,text:e})});if(lucid.object.isEmpty(d))e(f);else{g=lucid.template.builder();
d.foreignBlock&&(g.add({tag:"span",text:i18n.get("plugin-mindmapping-export-foreignblock"),classes:"warning"}),g.spacer());d.multiParent&&g.add({tag:"p",classes:"warning",html:i18n.get("plugin-mindmapping-export-multiparent",{},["{}<br>",'<a href="http://support.lucidchart.com/entries/21777820-Mind-mapping#troubleshooting" target="_blank">{}</a>'])});var m=lucid.dialog.custom(g.getTemplate(),{modal:!0,preventEsc:!0,classes:"mind-map-dialog",buttons:[{label:i18n.get("confirm-ok"),action:function(){m.close();
e(f)}}]});m.open()}}}}]}});
//# sourceMappingURL=/js/plugins/v2/source-maps/mindmap.js.map

};

pluginFn['/js/plugins/v2/computation.js'] = function(lucid, window) {
	var f=f||{};f.scope={};f.ASSUME_ES5=!1;f.ASSUME_NO_NATIVE_MAP=!1;f.ASSUME_NO_NATIVE_SET=!1;f.defineProperty=f.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};f.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};f.global=f.getGlobal(this);f.SYMBOL_PREFIX="jscomp_symbol_";
f.initSymbol=function(){f.initSymbol=function(){};f.global.Symbol||(f.global.Symbol=f.Symbol)};f.symbolCounter_=0;f.Symbol=function(a){return f.SYMBOL_PREFIX+(a||"")+f.symbolCounter_++};f.initSymbolIterator=function(){f.initSymbol();var a=f.global.Symbol.iterator;a||(a=f.global.Symbol.iterator=f.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&f.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return f.arrayIterator(this)}});f.initSymbolIterator=function(){}};
f.arrayIterator=function(a){var b=0;return f.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};f.iteratorPrototype=function(a){f.initSymbolIterator();a={next:a};a[f.global.Symbol.iterator]=function(){return this};return a};
f.iteratorFromArray=function(a,b){f.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
f.polyfill=function(a,b){if(b){var c=f.global;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&f.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};f.polyfill("Array.prototype.keys",function(a){return a?a:function(){return f.iteratorFromArray(this,function(a){return a})}},"es6","es3");var k={common:{}};k.common.DocVersionedProps={};k.common.DocVersionedProps.getValueForDocVersion=function(a,b){var c=lucid.plugin.getProperty(null,"Version")||0;return(a=lucid.array.findRight(a,function(a){return a.docVersionInstated<=c}))&&a.value||b};k.common.TextAreaOverflowUtils={};k.common.TextAreaOverflowUtils.getOnOverflowCallback=function(a,b,c){return function(d,e,g,h,m){if("number"!==typeof h||"number"!==typeof m||(h+6)%3!=(m+6)%3)h=lucid.plugin.getProperty(null,"Version")||0,m=Math.abs(lucid.text.getTextAreaRotation(d,e)),e!=(c||"Text")||0!==g||5>h||0!==m||k.common.TextAreaOverflowUtils.resizeToFitText(d,e,g,a,b)}};
k.common.TextAreaOverflowUtils.resizeToFitText=function(a,b,c,d,e){var g=lucid.plugin.getProperty(a,"BoundingBox"),h=d(g,a);d=lucid.text.getTextAreaVAlignment(a,b);d="middle"==d?{x:.5,y:.5}:"bottom"==d?{x:.5,y:1}:{x:.5,y:0};b=lucid.text.getTextAreaSpaceSize(a,b,c);b=lucid.math.Box.resizeAboutRelativePoint(h,d,b);e=e(b,a);b=e.h>g.h;c=lucid.block.getDefaultSize(a).h;e=lucid.math.Box.resizeAboutRelativePoint(g,d,{w:g.w,h:b?Math.max(e.h,g.h):Math.max(e.h,Math.min(g.h,c))});lucid.plugin.setProperty(a,
"BoundingBox",e)};k.computation={};lucid.computation={};lucid.computation.Environment=function(){this.readyNodes=[];this.nodes=[]};lucid.computation.Environment.prototype.addReadyNode=function(a){this.readyNodes.push(a)};lucid.computation.Environment.prototype.createNode=function(a){a=new lucid.computation.Node(a,this);this.nodes.push(a);return a};lucid.computation.Environment.prototype.run=function(){var a=this.readyNodes;this.readyNodes=[];a.forEach(function(a){a.run()})};
lucid.computation.Environment.prototype.finished=function(){return 1>this.readyNodes.length};lucid.computation.Node=function(a,b){this.inputs={};this.namedOutputs={};this.generalOutputs=[];this.calculation=a;this.environment=b};lucid.computation.Node.prototype.connectInput=function(a){var b=new lucid.computation.Input(this,null);return this.inputs[a]=b};lucid.computation.Node.prototype.connectOutput=function(a,b){a?this.namedOutputs[a]=b:this.generalOutputs.unshift(b)};
lucid.computation.Node.prototype.trigger=function(){var a=!0,b;for(b in this.inputs)null==this.inputs[b].getValue()&&(a=!1);a&&this.environment.addReadyNode(this)};lucid.computation.Node.prototype.run=function(){var a={},b;for(b in this.inputs)a[b]=this.inputs[b].getValue();var c=this.calculation.call(this.calculation,a),d;for(d in c)"general"==d?this.generalOutputs.forEach(function(a){a.setValue(c[d])}):d in this.namedOutputs&&this.namedOutputs[d].setValue(c[d])};lucid.computation.Target=function(){};
lucid.computation.Target.prototype.setValue=function(){};lucid.computation.Input=function(a,b){this.node=a;this.value=null;this.setValue(b)};lucid.computation.Input.prototype.setValue=function(a){this.value!==a&&(this.value=a,this.node.trigger())};lucid.computation.Input.prototype.getValue=function(){return this.value};lucid.computation.functions={};lucid.computation.functions.adder=function(a){var b={general:0};for(key in a)b.general+=a[key];return b};
lucid.computation.functions.multiplier=function(a){var b={general:1};for(key in a)b.general*=a[key];return b};lucid.computation.functions.identity=function(a){for(key in a)return{general:a[key]}};lucid.computation.functions.getFunctionByName=function(a){if(0==a.indexOf("lucid.computation.functions")&&(a=a.slice(28),a in lucid.computation.functions))return lucid.computation.functions[a];throw"Unknown function "+a+" in computation plugin";};function l(a,b){return 0==a%1?a.toString():a.toFixed(b)}
var n=[{name:"Default",func:l},{name:"Currency",func:function(a,b){return"$"+a.toFixed(b)}},{name:"Percent",func:function(a,b){return(100*a).toFixed(b)+"%"}},{name:"Scientific",func:function(a,b){return a.toPrecision(b)}}];lucid.computation.parseNumber=function(a){a=a.replace("$","").replace(",","").trim();var b=Number(a);return isNaN(b)?"%"!=a.substr(a.length-1)||(a=Number(a.substr(0,a.length-1)),isNaN(a))?null:a/100:b};
lucid.computation.getFormattedNumber=function(a,b,c){var d=n.filter(function(b){return b.name==a});return(0<d.length?d[0].func:l).call(null,b,c)};lucid.computation.getNumberLabels=function(a){a=lucid.plugin.getProperty(a,"TextAreas");var b=[],c;for(c in a)if(a[c]&&a[c].Value){var d=lucid.computation.parseNumber(a[c].Value.t);d&&b.push(d)}return b};lucid.computation.getNumber=function(a,b){b=b||1;a=lucid.computation.getNumberLabels(a);return 1>a.length?b:a[0]};
lucid.computation.getOrientedLineEnds=function(a){var b=lucid.plugin.getProperty(a,"Endpoint1");a=lucid.plugin.getProperty(a,"Endpoint2");return{startEnd:"None"==b.Style?b:a,endEnd:"None"==b.Style?a:b}};lucid.computation.Annotation=function(a,b,c){this.items=a;this.message=b;this.type=c};lucid.computation.CompiledPage=function(a){this.environment=a;this.warnings=[];this.inputTargets={};this.outputTargets={}};lucid.computation.CompiledPage.prototype.addWarnings=function(a){this.warnings=this.warnings.concat(a)};
lucid.computation.CompiledPage.prototype.addInput=function(a,b,c){a in this.inputTargets||(this.inputTargets[a]={});this.inputTargets[a][b]=c};lucid.computation.CompiledPage.prototype.addOutputNode=function(a,b,c){a in this.outputTargets||(this.outputTargets[a]={});this.outputTargets[a][b]=c};lucid.computation.CompiledPage.prototype.refresh=function(a,b,c){"string"===typeof c&&(c=lucid.computation.parseNumber(c)||0);a in this.inputTargets&&b in this.inputTargets[a]&&this.inputTargets[a][b].setValue(c)};
lucid.computation.CompiledPage.prototype.run=function(){for(;!this.environment.finished();)this.environment.run();return!0};lucid.computation.CompiledPage.prototype.getLiveItemIds=function(){return Object.keys(this.inputTargets).concat(Object.keys(this.outputTargets))};lucid.computation.ValueOutput=function(a,b){this.block=a;this.key=b};
lucid.computation.ValueOutput.prototype.setValue=function(a){var b=lucid.plugin.getProperty(this.block,"CMP_TXT_"+this.key,!0);if(b!=a){lucid.plugin.setProperty(this.block,"CMP_TXT_"+this.key,a,!0);var c=lucid.plugin.getProperty(this.block,"ChangeCallback",!0);c&&c(b,a,this.key)}};lucid.computation.Compiler=function(a){this.page=a};
lucid.computation.Compiler.prototype.compile=function(){function a(a){return!!lucid.plugin.getProperty(a,"Annotations",!0)}lucid.plugin.getAllLineIds(a).concat(lucid.plugin.getAllBlockIds(a)).forEach(function(a){lucid.plugin.setProperty(a,"Annotations",void 0,!0)});var b=this.getActiveElements(),c=b.blocks,d=b.lines;c.concat(d);b=this.validateBlocks(c);var e=this.validateLines(d);if(0<b.length+e.length)return b.concat(e);b=this.findDeadlocks(c,d);if(0<b.length)return b;var g=new lucid.computation.Environment,
h=new lucid.computation.CompiledPage(g),m={};c.forEach(function(a){var b=lucid.computation.functions.getFunctionByName(lucid.plugin.getProperty(a,"CMP_GetCalculation"));m[a]={node:g.createNode(b),targeted:!1}}.bind(this));d.forEach(function(a){var b=lucid.computation.getOrientedLineEnds(a);if(b.startEnd.Block){var e=this.findAttachedBlocks(d,a,b.endEnd);if(0<e.length){var p=g.createNode(lucid.computation.functions.multiplier),t=p.connectInput("block"),O=p.connectInput("label");h.addInput(a,"label",
O);c.forEach(function(a){a==b.startEnd.Block&&m[a].node.connectOutput(null,t)}.bind(this));e.forEach(function(b,c){b in m&&(p.connectOutput(null,m[b].node.connectInput(a+c.toString())),m[b].targeted=!0)}.bind(this))}}}.bind(this));b=[];for(var p in m)lucid.plugin.getProperty(p,"CMP_FixedInput")&&m[p].targeted&&b.push(new lucid.computation.Annotation([p],"Block with fixed IO type input cannot be a target of data","Error")),lucid.plugin.setPropertyIfChanged(p,"CMP_IsInput",!m[p].targeted,!0),m[p].targeted?
(e=new lucid.computation.ValueOutput(p,"Value"),m[p].node.connectOutput(null,e),h.addOutputNode(p,"value",m[p].node)):(e=m[p].node.connectInput("value"),h.addInput(p,"value",e));return 0<b.length?b:h};
lucid.computation.Compiler.prototype.findAttachedBlocks=function(a,b,c){var d=[],e=lucid.computation.getOrientedLineEnds(b);e.endEnd.Block&&d.push(e.endEnd.Block);this.getAllLinesTouching(b).filter(function(a){return null==c||c!=a}.bind(this)).forEach(function(c){d=d.concat(this.findAttachedBlocks(a,c,b))}.bind(this));return d};lucid.computation.Compiler.prototype.validateBlocks=function(){return[]};
lucid.computation.Compiler.prototype.getAllLinesTouching=function(a){var b=lucid.plugin.getLinesAttachedTo(a),c=lucid.plugin.getProperty(a,"Endpoint1").Line;a=lucid.plugin.getProperty(a,"Endpoint2").Line;c&&0>b.indexOf(c)&&b.push(c);a&&0>b.indexOf(a)&&b.push(a);return b};
lucid.computation.Compiler.prototype.validateLines=function(a){var b=[];a.forEach(function(c){var d=lucid.plugin.getProperty(c,"Endpoint1"),e=lucid.plugin.getProperty(c,"Endpoint2");"None"!=d.Style&&"None"!=e.Style?b.push(new lucid.computation.Annotation([c],"Action line must have exactly one arrow","Error")):"None"==d.Style&&"None"==e.Style&&b.push(new lucid.computation.Annotation([c],"Action line must have exactly one arrow","Error"));var g="None"==d.Style?d:e,h="None"==d.Style?e:d;h.Line&&(e=a.filter(function(a){return a==
h.Line}.bind(this))[0],d=lucid.plugin.getProperty(e,"Endpoint1"),e=lucid.plugin.getProperty(e,"Endpoint2"),d=d.Line==c?d:e,d.Line==c&&"None"==d.Style||b.push(new lucid.computation.Annotation([c],"Action lines cannot merge","Error")));d=lucid.computation.getNumberLabels(c);g.Line&&0<d.length?b.push(new lucid.computation.Annotation([c],"Branched line cannot have weighting","Error")):1<d.length&&b.push(new lucid.computation.Annotation([c],"Line cannot have multiple weightings","Error"))}.bind(this));
return b};
lucid.computation.Compiler.prototype.getActiveElements=function(){var a=lucid.plugin.getAllBlockIds(function(a){return-1<lucid.plugin.getBlockClassName(a).indexOf("CMP_")&&lucid.plugin.getItemPageId(a)==this.page}.bind(this)),b={};a.forEach(function(a){for(var c=lucid.plugin.getLinesAttachedTo(a);0<c.length;){var d=[];c.forEach(function(c){c in b?0>b[c].indexOf(a)&&(b[c].push(a),d=d.concat(this.getAllLinesTouching(c))):(b[c]=[a],d=d.concat(this.getAllLinesTouching(c)))}.bind(this));c=d}}.bind(this));var c=
[],d;for(d in b)1<b[d].length&&c.push(d);return{blocks:a,lines:c}};
lucid.computation.Compiler.prototype.findDeadlocks=function(a,b){function c(a,b){if(e[a])return[b.slice(b.indexOf(a))];if(h[a])return[];e[a]=!0;var d=m[a]?lucid.array.flatMap(m[a],function(d){return c(d,b.concat([a]))}):[];e[a]=!1;g[a]=!0;return d}function d(a){var b=lucid.plugin.getLinesAttachedTo(a);lucid.array.removeDuplicates(b);b=lucid.array.filter(b,function(b){b=lucid.computation.getOrientedLineEnds(b).startEnd;return(b.Line||b.Block)==a});if(lucid.plugin.isBlock(a))return b;var c=lucid.computation.getOrientedLineEnds(a).endEnd;
return(c=c.Line||c.Block)?b.concat([c]):b}a=a.concat(b);if(1>a.length)return[];var e={},g={},h={};a.forEach(function(a){e[a]=!1;g[a]=!1});var m={};a.forEach(function(a){m[a]=d(a)});b=[];for(var p in a){var t=a[p];if(!g[t]){b=b.concat(c(t,[]));for(var B in g)g[B]&&(h[B]=!0),g[B]=!1}}return lucid.array.map(b,function(a){return new lucid.computation.Annotation(a,"Loop detected!","Error")})};lucid.computation.panels={};
lucid.computation.panels.annotationsPanel=function(a){var b=lucid.template.builder();a={tag:"table",children:[{tag:"tbody",children:lucid.array.map(a,function(a){return{tag:"tr",children:[{tag:"td",text:a.type},{tag:"td",text:a.message}]}})}]};b.add(a);return b};
lucid.computation.panels.gsheetsReactivatePanel=function(){var a=lucid.template.builder();a.addButton({label:"Connect to Sheets",onClick:function(){lucid.computation.googleapp.doWithAuth("ping",[],function(){lucid.computation.googleapp.reconnectedAlert||(lucid.computation.googleapp.reconnectedAlert=!0,lucid.dialog.alert("We've successfully connected to Google Sheets."))},function(){lucid.dialog.alert("We were unable to connected to Google Sheets.")},!0)}});return a};
lucid.plugin.onDocumentLoaded(function(){var a=lucid.template.builder(),b=a.add();lucid.plugin.addCustomPanel("Context Panel",null,[{content:a}],null,{isContextPanel:!0,checkShow:function(c){c=c.filter(function(a){return a.isBlock&&0==a.className.indexOf("CMP_")||!!lucid.plugin.getProperty(a.id,"Annotations",!0)});if(1!=c.length)return!1;c=c[0];var d=lucid.template.builder();return(c=lucid.plugin.getProperty(c.id,"Annotations",!0))?(d=lucid.computation.panels.annotationsPanel(c),a.getElement(b).setContent(d),
!0):!1},refreshProperties:"gs_SheetId gs_SheetIdVerified gs_Cell gs_WorksheetId gs_Worksheets gs_SelectionOptions gs_HideControls".split(" ")})});function q(){lucid.plugin.getAllBlockIds(function(a){return!!lucid.plugin.getProperty(a,"CMP_UpdateFunction",!0)&&!lucid.plugin.getProperty(a,"CMP_Suspended",!0)}).forEach(function(a){lucid.plugin.getProperty(a,"CMP_UpdateFunction",!0).call(void 0,a);lucid.computation.recalculateAll&&lucid.computation.recalculateAll()});setTimeout(q,100)}
lucid.computation.recompileAll=void 0;lucid.computation.recalculateAll=void 0;
lucid.plugin.onDocumentLoaded(function(){function a(a){var b={};a.forEach(function(a){a.items.forEach(function(c){c in b||(b[c]=[]);b[c].unshift({message:a.message,type:a.type})})}.bind(this));for(var c in b)lucid.plugin.setPropertyIfChanged(c,"Annotations",b[c],!0)}q();var b={};lucid.computation.recompileAll=function(){b={};for(var c=lucid.plugin.getAllPages(),d=0;d<c.length;d++){var e=c[d],g=(new lucid.computation.Compiler(e)).compile();b[e]=g;g.run?(g.getLiveItemIds().forEach(function(a){var b=
g;if(lucid.plugin.isBlock(a)){var c=lucid.plugin.getProperty(a,"CMP_TXT_Value",!0);c||(c=lucid.plugin.getProperty(a,"Value").t);b.refresh(a,"value",c,!0)}else!lucid.plugin.isLine(a)||1<lucid.computation.getNumberLabels(a).length||b.refresh(a,"label",lucid.computation.getNumber(a,1),!0)}.bind(this)),g.run()):a(g)}};lucid.computation.recalculateAll=function(){var c=lucid.plugin.getActivePageId(),d=b[c];d&&(d.run?(d.getLiveItemIds().forEach(function(a){if(lucid.plugin.isBlock(a)){var b=lucid.plugin.getProperty(a,
"CMP_TXT_Value",!0);d.refresh(a,"value",b,!0)}else!lucid.plugin.isLine(a)||1<lucid.computation.getNumberLabels(a).length||d.refresh(a,"label",lucid.computation.getNumber(a,1),!0)}.bind(this)),d.run()):a(d))};lucid.computation.recompileAll()});
lucid.computation.renderErrors=function(){function a(a,c){var d=lucid.plugin.getProperty(a,"Annotations",!0);d&&lucid.plugin.setPropertyIfChanged(a,c,b(d))}function b(a){return a.some(function(a){return"Error"==a.type})?"#FF0000":"#FFFF00"}var c=lucid.plugin.getAllBlockIds(function(a){return!!lucid.plugin.getProperty(a,"Annotations",!0)}),d;for(d in c)a(c[d],"FillColor");c=lucid.plugin.getAllLineIds(function(a){return!!lucid.plugin.getProperty(a,"Annotations",!0)});for(var e in c)a(c[e],"LineColor")};
lucid.computation.renderDynamicProperties=function(){lucid.plugin.getAllBlockIds().concat(lucid.plugin.getAllLineIds()).forEach(function(a){if(!lucid.plugin.getProperty(a,"CMP_IsEditing",!0)){var b=lucid.plugin.getAllProperties(a,!0),c;for(c in b)if(0==c.indexOf("CMP_")){var d=b[c];0==c.indexOf("CMP_TXT_")?lucid.plugin.setTextIfChanged(a,c.slice(8),d):lucid.plugin.setPropertyIfChanged(a,c.slice(4),d)}lucid.plugin.prerenderActions(a)}})};lucid.computation.isRenderingProperties=!1;
lucid.computation.renderProperties=function(){lucid.computation.isRenderingProperties=!0;lucid.computation.renderDynamicProperties();lucid.computation.renderErrors();lucid.computation.isRenderingProperties=!1};lucid.plugin.provideRenderProperties(lucid.computation.renderProperties);var r=[lucid.ActionType.CreateBlock,lucid.ActionType.CreateLine,lucid.ActionType.SetProperty,lucid.ActionType.RemoveBlock,lucid.ActionType.RemoveLine,lucid.ActionType.CreatePage,lucid.ActionType.RemovePage],u=[lucid.ActionType.EditText];
lucid.plugin.onAction(function(a){lucid.computation.isRenderingProperties||lucid.computation.recompileAll&&(-1<r.indexOf(a.Action)?lucid.computation.recompileAll():-1<u.indexOf(a.Action)&&lucid.computation.recalculateAll())});
var v={defaultSize:{w:200,h:150},registerProperties:function(a){lucid.plugin.registerProperty(a,"TextWrap","fit");lucid.plugin.registerProperty(a,"InsetMargin",5);lucid.plugin.registerProperty(a,"CMP_FixedInput",!1);lucid.plugin.registerProperty(a,"CMP_IsEditable",!0);lucid.plugin.registerProperty(a,"CMP_GetCalculation","lucid.computation.functions.adder");lucid.plugin.registerProperty(a,"CMP_HasLabel",!0);lucid.plugin.registerProperty(a,"CMP_Formatter",n[0].name);lucid.plugin.registerProperty(a,
"CMP_FormattingDigits",2);lucid.plugin.hookPropertyPostSave(a,"Value",function(b,c){lucid.plugin.getProperty(a,"CMP_IsInput",!0)&&lucid.plugin.getProperty(a,"CMP_IsEditable")&&lucid.plugin.setProperty(a,"CMP_TXT_Value",c.t,!0)})},onInit:function(a){lucid.plugin.addBlockTextArea(a,{id:"Text",value:"LABEL",vAlign:"bottom",getBoundingBox:function(b){if(!lucid.plugin.getProperty(a,"CMP_HasLabel"))return null;b=lucid.math.Box.pad({x:b.x,y:b.y,w:b.w,h:.4*b.h},-lucid.plugin.getProperty(a,"InsetMargin")||
0);b.hideOverflow=!0;return b}});lucid.plugin.addBlockTextArea(a,{id:"Value",value:"0",vAlign:"middle",getBoundingBox:function(b){var c=.6;lucid.plugin.getProperty(a,"CMP_HasLabel")||(c=1);b=lucid.math.Box.pad({x:b.x,y:b.y+b.h*(1-c),w:b.w,h:b.h*c},-lucid.plugin.getProperty(a,"InsetMargin")||0);b.hideOverflow=!0;return b},beforeTextEdit:function(){var b=lucid.plugin.getProperty(a,"CMP_IsInput",!0)&&lucid.plugin.getProperty(a,"CMP_IsEditable");b&&lucid.plugin.setProperty(a,"CMP_IsEditing",!0,!0);return b},
afterTextEdit:function(){lucid.plugin.setProperty(a,"CMP_IsEditing",!1,!0)}});lucid.plugin.setProperty(a,"CMP_IsInput",!1,!0);v.registerProperties(a)},linkPoints:function(){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},baseRenderActions:function(a,b){return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:a.y},{Action:"line",x:a.x+a.w,y:a.y},{Action:"line",x:a.x+a.w,
y:a.y+a.h},{Action:"line",x:a.x,y:a.y+a.h},{Action:"close"}]}]},prerenderActions:function(a){var b=lucid.plugin.getProperty(a,"Value");b=(b=b&&b.t)&&lucid.computation.parseNumber(b);if(null!==b&&void 0!==b){var c=lucid.plugin.getProperty(a,"CMP_Formatter"),d=lucid.plugin.getProperty(a,"CMP_FormattingDigits");lucid.plugin.setPropertyIfChanged(a,"Value",lucid.computation.getFormattedNumber(c,b,d))}}};function w(a){var b=lucid.object.clone(v);lucid.object.extend(b,a);return b}
function x(a,b,c){return{Action:"line",x:a.x+a.w*b,y:a.y+a.h*c}}function y(a,b,c){return{Action:"move",x:a.x+a.w*b,y:a.y+a.h*c}}function z(a,b,c,d,e,g,h){return{Action:"curve",Control:[{x1:a.x+a.w*b,y1:a.y+a.h*c,x2:a.x+a.w*d,y2:a.y+a.h*e,x3:a.x+a.w*g,y3:a.y+a.h*h}]}}function A(){return{Action:"close"}}
function C(a,b){function c(a,b,c){return x(a,b/150,c/150)}function d(a,b,c){return y(a,b/150,c/150)}var e=.9*Math.min(b.w,b.h);b=lucid.math.Box.create(b.x+(b.w-e)/2,b.y+(b.h-e)/2,e,e);switch(a){case "CMP_GoogleSheetsInputBlock":return[[d(b,25,55),c(b,25,125),c(b,125,125),c(b,125,55),c(b,102,55),c(b,102,40),c(b,140,40),c(b,140,47.5),c(b,140,140),c(b,131,140),c(b,19.5,140),c(b,10,140),c(b,10,47.5),c(b,10,40),c(b,48,40),c(b,48,60),c(b,25,60),A(),d(b,82,75),c(b,82,5),c(b,68,5),c(b,68,75),c(b,48,75),c(b,
75,115),c(b,102,75),c(b,82,75),A()]];case "CMP_GoogleSheetsOutputBlock":return[[d(b,25,74),c(b,25,125),c(b,125,125),c(b,125,74),c(b,101,74),c(b,101,59),c(b,140,59),c(b,140,66.5),c(b,140,132.5),c(b,140,140),c(b,10,140),c(b,10,132.5),c(b,10,66.5),c(b,10,59),c(b,49,59),c(b,49,74),c(b,25,74),A(),d(b,82,40),c(b,82,110),c(b,68,110),c(b,68,40),c(b,48,40),c(b,75,0),c(b,102,40),c(b,82,40),A()]];case "CMP_GoogleSheetsListBlock":return[[d(b,140,20),c(b,40,20),c(b,40,38),c(b,140,38),c(b,140,20),A(),d(b,30,20),
c(b,10,20),c(b,10,38),c(b,30,38),c(b,30,20),A(),d(b,140,66),c(b,40,66),c(b,40,84),c(b,140,84),c(b,140,66),A(),d(b,30,66),c(b,10,66),c(b,10,84),c(b,30,84),c(b,30,66),A(),d(b,140,112),c(b,40,112),c(b,40,130),c(b,140,130),c(b,140,112),A(),d(b,30,112),c(b,10,112),c(b,10,130),c(b,30,130),c(b,30,112),A()]];case "CMP_GoogleSheetsDynamicTextBlock":return[[d(b,6.818181818,75),c(b,28.0909091,109),c(b,47.7272727,109),c(b,20.4545455,75),c(b,47.7272727,41),c(b,34.0909091,41),c(b,.818181818,75),A(),d(b,129.545455,
75),c(b,102.2727273,109),c(b,115.909091,109),c(b,143.181818,75),c(b,115.909091,41),c(b,102.2727273,41),c(b,129.545455,75),A(),d(b,81.8181818,20),c(b,54.5454545,130),c(b,68.1818182,130),c(b,95.4545455,20),c(b,81.8181818,20),A()]];case "CMP_AdditionSquareBlock":return[[d(b,68,68),c(b,35,68),c(b,35,82),c(b,68,82),c(b,68,115),c(b,82,115),c(b,82,82),c(b,115,82),c(b,115,68),c(b,82,68),c(b,82,35),c(b,68,35),c(b,68,68),A(),d(b,5,5),c(b,145,5),c(b,145,15),c(b,5,15),c(b,5,5),A(),d(b,5,135),c(b,145,135),c(b,
145,145),c(b,5,145),c(b,5,135),A(),d(b,5,5),c(b,5,145),c(b,15,145),c(b,15,5),c(b,5,5),A(),d(b,135,5),c(b,135,145),c(b,145,145),c(b,145,5),c(b,135,5),A()]];default:return[[]]}}
function D(a,b){var c=b.BoundingBox,d=!lucid.object.isObject(b.FillColor)&&lucid.object.areEqual(lucid.color.hex(b.FillColor),lucid.color.hex("#FFFFFF"));return C(a,c).map(function(a){return{FillColor:d?"#F3F3F3":lucid.color.lighten(b.FillColor,.35),StrokeColor:d?"#F3F3F3":lucid.color.lighten(b.FillColor,.35),LineWidth:1,NoRounding:!0,Actions:a}})}
lucid.plugin.initBlockClass(w({className:"CMP_AdditionSquareBlock",name:"Combination Block",searchKeywords:["block","square","rectangle","box"],getRenderData:function(a,b){var c=a.BoundingBox;return"sample"==b?(a=c.w>c.h?c.w:c.h,c=c.x<c.y?c.x:c.y,c={x:c,y:c,w:a,h:a},a=E(c),c=[{FillColor:"#FFFFFF",StrokeWidth:2,Actions:[y(c,.527,.5),x(c,.527,.321),x(c,.455,.321),x(c,.455,.5),x(c,.277,.5),x(c,.277,.571),x(c,.455,.571),x(c,.455,.75),x(c,.527,.75),x(c,.527,.571),x(c,.705,.571),x(c,.705,.5),A()]}],a.concat(c)):
v.baseRenderActions(c,a).concat(D("CMP_AdditionSquareBlock",a))}}));function E(a){return[{FillColor:"#319F58",line:!1,Actions:[y(a,.107,.107),z(a,.107,.048,.1551,0,.214,0),x(a,.643,0),x(a,.893,.25),x(a,.893,.893),z(a,.893,.952,.845,1,.786,1),x(a,.214,1),z(a,.155,1,.107,.952,.107,.893),x(a,.107,.107),A()]},{FillColor:"#85CBA9",line:!1,Actions:[y(a,.643,0),x(a,.893,.25),x(a,.643,.25),A()]},{FillColor:"#25783F",line:!1,Actions:[y(a,.893,.456),x(a,.893,.25),x(a,.643,.25),A()]}]}
function F(a){a=lucid.plugin.getProperty(a,"gs_SheetId");var b=/(https?:\/\/)?docs.google.com\/spreadsheets\/d\/([^/]*)(\/.*)?/.exec(a);return b?b[2]:a}function G(a){try{var b=a.search(/[0-9]/),c=Number(a.substring(b)),d=a.substring(0,b).toLowerCase();for(b=a=0;b<d.length;b++){var e=d.charCodeAt(b);a=26*a+(e-97+1)}return{r:c,c:a}}catch(g){return null}}
lucid.computation.googleapp={id:lucid.config.google_sheets&&lucid.config.google_sheets.appId,mode:lucid.config.google_sheets&&lucid.config.google_sheets.mode,clientId:lucid.config.google_sheets&&lucid.config.google_sheets.clientId,scopes:"https://www.googleapis.com/auth/script.external_request https://www.googleapis.com/auth/script.scriptapp https://www.googleapis.com/auth/script.storage https://www.googleapis.com/auth/spreadsheets https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/drive.readonly".split(" "),
accessToken:void 0,accessExisted:!1,accessSuspended:!1,reconnectedAlert:!1};
lucid.computation.googleapp.makeGoogleSheetCall=function(a,b,c,d){$.ajax({type:"POST",headers:{Accept:"application/json; charset=utf-8",Authorization:"Bearer "+lucid.computation.googleapp.accessToken,"Content-Type":"application/json"},url:"https://script.googleapis.com/v1/scripts/"+lucid.computation.googleapp.id+":run",data:JSON.stringify({"function":a,parameters:b,sessionState:"",devMode:"dev"==lucid.computation.googleapp.mode}),crossDomain:!0,dataType:"json",success:function(a){a.response?c(a.response.result):
a.error&&d&&d(a.error)},error:function(a){d&&d(a)}})};
lucid.computation.googleapp.doWithAuth=function(a,b,c,d,e){function g(a){lucid.computation.googleapp.accessSuspended||(lucid.computation.googleapp.accessSuspended=!0,lucid.computation.googleapp.reconnectedAlert=!1,m.forEach(function(a){lucid.plugin.setPropertyIfChanged(a,"CMP_Suspended",!0,!0)}),d&&d(a),setTimeout(lucid.computation.googleapp.doWithAuth.bind(void 0,"ping",[],function(){lucid.computation.googleapp.reconnectedAlert||(lucid.computation.googleapp.reconnectedAlert=!0,lucid.dialog.alert("We've successfully connected to Google Sheets"))}),
6E4))}function h(e){lucid.computation.googleapp.accessToken=e;lucid.computation.googleapp.accessSuspended=!1;lucid.computation.googleapp.accessExisted=!0;m.forEach(function(a){lucid.plugin.setPropertyIfChanged(a,"CMP_Suspended",null,!0);var b=lucid.plugin.getProperty(a,"CMP_UpdateFunction",!0);b&&b(a)});lucid.computation.googleapp.doWithAuth(a,b,c,d)}var m=lucid.plugin.getAllBlockIds(function(a){return 0==lucid.plugin.getBlockClassName(a).indexOf("CMP_Google")});if(void 0==lucid.computation.googleapp.accessToken||
null==lucid.computation.googleapp.accessToken)var p=lucid.plugin.getGoogleAuthorizer(lucid.computation.googleapp.scopes.join(" "),lucid.computation.googleapp.clientId,h,function(){lucid.computation.googleapp.accessSuspended&&!e||lucid.dialog.confirm(lucid.computation.googleapp.accessExisted?e?"Try to reconnect with Google Sheets?":"Whoops!  We can't seem to see Google Sheets any more.  Should we try to reconnect?":"A Google Sheets shape is requesting access to Google Sheets.  Allow Lucidchart to access Google Sheets?",
function(){p.authorize(h,g,!1)},g,["Yes","No"])});else lucid.computation.googleapp.makeGoogleSheetCall(a,b,c,function(e){401==e.status?(lucid.computation.googleapp.accessToken=void 0,lucid.computation.googleapp.doWithAuth(a,b,c,d)):d&&d(e)})};lucid.computation.GoogleSheetCacher={};lucid.computation.GoogleSheetCacher.cache={};lucid.computation.GoogleSheetCacher.pending={};lucid.computation.GoogleSheetCacher.colorCache={};lucid.computation.GoogleSheetCacher.colorPending={};
lucid.computation.GoogleSheetCacher.timeout=Number(lucid.config.google_sheets&&lucid.config.google_sheets.timeOutLengthMs)||1E3;lucid.computation.GoogleSheetCacher.cellKey=function(a,b,c){return"R"+c.r+"C"+c.c+":"+a+":"+b};lucid.computation.GoogleSheetCacher.rangeKey=function(a,b,c,d){return"Range"+("R"+c.r+"C"+c.c)+"To"+("R"+d.r+"C"+d.c)+":"+a+":"+b};
lucid.computation.GoogleSheetCacher.clearCache=function(){lucid.computation.GoogleSheetCacher.cache={};lucid.computation.GoogleSheetCacher.colorCache={}};function H(){lucid.computation.GoogleSheetCacher.clearCache();setTimeout(H,lucid.computation.GoogleSheetCacher.timeout)}lucid.computation.GoogleSheetCacher.running=!1;
lucid.computation.GoogleSheetCacher.setCacheCell=function(a,b){lucid.computation.GoogleSheetCacher.running||(lucid.computation.GoogleSheetCacher.running=!0,setTimeout(H,lucid.computation.GoogleSheetCacher.timeout));b!==lucid.computation.GoogleSheetCacher.cache[a]&&(lucid.computation.GoogleSheetCacher.cache[a]=b)};
lucid.computation.GoogleSheetCacher.getCell=function(a,b,c,d,e,g){var h=lucid.computation.GoogleSheetCacher.cellKey(a,b,c);h in lucid.computation.GoogleSheetCacher.cache?e(lucid.computation.GoogleSheetCacher.cache[h]):lucid.computation.GoogleSheetCacher.pending[d]||(lucid.computation.GoogleSheetCacher.pending[d]=!0,lucid.computation.googleapp.doWithAuth("getCellValues",[a,b,c.r,c.c,1,1],function(a){delete lucid.computation.GoogleSheetCacher.pending[d];a=String(a[0][0]);lucid.computation.GoogleSheetCacher.setCacheCell(h,
a);e(a)},function(a){delete lucid.computation.GoogleSheetCacher.pending[d];g&&g(a)}))};
lucid.computation.GoogleSheetCacher.getRange=function(a,b,c,d,e,g,h){var m=lucid.computation.GoogleSheetCacher.rangeKey(a,b,c,d);if(m in lucid.computation.GoogleSheetCacher.cache)g(lucid.computation.GoogleSheetCacher.cache[m]);else if(!lucid.computation.GoogleSheetCacher.pending[e]){lucid.computation.GoogleSheetCacher.pending[e]=!0;var p=Math.min(c.r,d.r),t=Math.min(c.c,d.c);lucid.computation.googleapp.doWithAuth("getCellValues",[a,b,p,t,Math.max(c.r,d.r)-p+1,Math.max(c.c,d.c)-t+1],function(a){delete lucid.computation.GoogleSheetCacher.pending[e];
lucid.computation.GoogleSheetCacher.setCacheCell(m,a);g(a)},function(a){delete lucid.computation.GoogleSheetCacher.pending[e];h&&h(a)})}};lucid.computation.GoogleSheetCacher.setCell=function(a,b,c,d){var e=lucid.computation.GoogleSheetCacher.cellKey(a,b,c);lucid.computation.googleapp.doWithAuth("setCellValues",[a,b,c.r,c.c,[[d]]],function(){lucid.computation.GoogleSheetCacher.clearCache();lucid.computation.GoogleSheetCacher.setCacheCell(e,d)})};
lucid.computation.GoogleSheetCacher.setCacheColor=function(a,b){lucid.computation.GoogleSheetCacher.colorCache[a]=b};
lucid.computation.GoogleSheetCacher.getColors=function(a,b,c,d,e,g){var h=lucid.computation.GoogleSheetCacher.cellKey(a,b,c);h in lucid.computation.GoogleSheetCacher.colorCache?e(lucid.computation.GoogleSheetCacher.colorCache[h]):lucid.computation.GoogleSheetCacher.colorPending[d]||(lucid.computation.GoogleSheetCacher.colorPending[d]=!0,lucid.computation.googleapp.doWithAuth("getCellColors",[a,b,c.r,c.c,1,1],function(a){delete lucid.computation.GoogleSheetCacher.colorPending[d];a=a[0][0];lucid.computation.GoogleSheetCacher.setCacheColor(h,
a);e(a)},function(a){delete lucid.computation.GoogleSheetCacher.colorPending[d];g&&g(a)}))};function I(a,b,c,d){var e=F(a),g=lucid.plugin.getProperty(a,"gs_WorksheetId");d=d||lucid.plugin.getProperty(a,"gs_Cell");var h=G(d);e&&h&&void 0!=g&&null!=g&&lucid.computation.GoogleSheetCacher.getColors(e,g,h,a+":"+d,b,c)}
function J(a,b,c,d){var e=F(a),g=lucid.plugin.getProperty(a,"gs_WorksheetId");d=d||lucid.plugin.getProperty(a,"gs_Cell");var h=G(d);e&&h&&void 0!=g&&null!=g&&lucid.computation.GoogleSheetCacher.getCell(e,g,h,a+":"+d,b,c)}
function K(a){var b=F(a),c=lucid.plugin.getProperty(a,"gs_WorksheetId"),d=G(lucid.plugin.getProperty(a,"gs_Cell")),e=lucid.plugin.getProperty(a,"CMP_TXT_Value",!0);if("number"==typeof e){var g=lucid.plugin.getProperty(a,"CMP_Formatter");a=lucid.plugin.getProperty(a,"CMP_FormattingDigits");e=lucid.computation.getFormattedNumber(g,e,a)}b&&void 0!=c&&null!=c&&d&&e&&lucid.computation.GoogleSheetCacher.setCell(b,c,d,e)}
function L(a){return function(){var b=F(a);lucid.plugin.setPropertyIfChanged(a,"gs_SheetIdVerified",!1);b&&lucid.computation.googleapp.doWithAuth("getWorksheets",[b],function(c){if(F(a)==b){lucid.plugin.setPropertyIfChanged(a,"gs_SheetIdVerified",!0);lucid.plugin.setPropertyIfChanged(a,"gs_Worksheets",c);var d=lucid.plugin.getProperty(a,"gs_WorksheetId");0==c.filter(function(a){return a.id==d}).length&&(lucid.plugin.setPropertyIfChanged(a,"gs_WorksheetId",c[0].id),(c=lucid.plugin.getProperty(a,"CMP_UpdateFunction",
!0))&&c(a))}})}}function M(a,b){lucid.plugin.setPropertyIfChanged(a,"CMP_TXT_Value",b,!0);var c=lucid.plugin.getProperty(a,"ChangeCallback",!0);a=lucid.plugin.getProperty(a,"CMP_TXT_Value",!0);c&&c(a,b,"Value")}function N(a,b){lucid.plugin.setProperty(a,"CMP_FillColor",b.background,!0)}function P(a,b){var c=0;return function(d,e,g,h){h||(c&&clearTimeout(c),c=setTimeout(function(){K(a);c=0},b))}}
function Q(a,b){if(void 0===b||!0===b)v.onInit(a);lucid.plugin.hookPropertyPostSave(a,"gs_SheetId",L(a));b="";for(var c=lucid.plugin.getAllBlockIds(),d=0;!b&&d<c.length;d++)lucid.plugin.getProperty(c[d],"gs_SheetIdVerified")&&(b=lucid.plugin.getProperty(c[d],"gs_SheetId"));b?lucid.plugin.setPropertyIfChanged(a,"gs_SheetId",b):lucid.plugin.setProperty(a,"gs_SheetId","");lucid.plugin.setProperty(a,"gs_Worksheets",[]);lucid.plugin.setProperty(a,"gs_Cell","")}
lucid.plugin.initBlockClass(w({className:"CMP_GoogleSheetsInputBlock",name:"Google Sheets Input",searchKeywords:"google sheets block square rectangle box".split(" "),getRenderData:function(a,b){var c=a.BoundingBox;return"sample"==b?(a=c.w>c.h?c.w:c.h,c=c.x<c.y?c.x:c.y,c={x:c,y:c,w:a,h:a},a=E(c),c=[{FillColor:"#FFFFFF",StrokeWidth:2,Actions:[y(c,.25,.429),x(c,.75,.429),x(c,.75,.821),x(c,.25,.821),A()]},{FillColor:"#319F58",StrokeWidth:2,Actions:[y(c,.286,.464),x(c,.714,.464),x(c,.714,.786),x(c,.286,
.786),A()]},{FillColor:"#429F5B",line:!1,Actions:[y(c,.393,.429),x(c,.607,.429),x(c,.607,.464),x(c,.393,.464),A()]},{FillColor:"#FFFFFF",line:!1,Actions:[y(c,.464,.286),x(c,.536,.286),x(c,.536,.571),x(c,.464,.571),A()]},{FillColor:"#FFFFFF",line:!1,Actions:[y(c,.357,.536),x(c,.5,.714),x(c,.643,.536),A()]}],a.concat(c)):v.baseRenderActions(c,a).concat(D("CMP_GoogleSheetsInputBlock",a))},onInit:function(a){Q(a);lucid.plugin.setProperty(a,"CMP_FixedInput",!0);lucid.plugin.setProperty(a,"CMP_IsEditable",
!1);lucid.plugin.setProperty(a,"CMP_UpdateFunction",function(a){J(a,function(b){M(a,b)});I(a,function(b){N(a,b)})},!0)}}));
lucid.plugin.initBlockClass(w({className:"CMP_GoogleSheetsOutputBlock",name:"Google Sheets Output",searchKeywords:"google sheets block square rectangle box".split(" "),getRenderData:function(a,b){var c=a.BoundingBox;return"sample"==b?(a=c.w>c.h?c.w:c.h,c=c.x<c.y?c.x:c.y,c={x:c,y:c,w:a,h:a},a=E(c),c=[{FillColor:"#FFFFFF",StrokeWidth:2,Actions:[y(c,.25,.429),x(c,.75,.429),x(c,.75,.821),x(c,.25,.821),A()]},{FillColor:"#319F58",StrokeWidth:2,Actions:[y(c,.286,.464),x(c,.714,.464),x(c,.714,.786),x(c,.286,
.786),A()]},{FillColor:"#429F5B",line:!1,Actions:[y(c,.393,.429),x(c,.607,.429),x(c,.607,.464),x(c,.393,.464),A()]},{FillColor:"#FFFFFF",line:!1,Actions:[y(c,.464,.393),x(c,.536,.393),x(c,.536,.678),x(c,.464,.678),A()]},{FillColor:"#FFFFFF",line:!1,Actions:[y(c,.357,.393),x(c,.5,.214),x(c,.643,.393),A()]}],a.concat(c)):v.baseRenderActions(c,a).concat(D("CMP_GoogleSheetsOutputBlock",a))},onInit:function(a){Q(a);lucid.plugin.hookPropertyPostSave(a,"gs_WorksheetId",P(a,100));lucid.plugin.hookPropertyPostSave(a,
"gs_Cell",P(a,100));lucid.plugin.hookPropertyPostSave(a,"Value",P(a,100));lucid.plugin.setProperty(a,"ChangeCallback",P(a,500),!0);lucid.plugin.setProperty(a,"CMP_UpdateFunction",function(a){I(a,function(b){N(a,b)})},!0)}}));
lucid.plugin.initBlockClass(w({className:"CMP_GoogleSheetsListBlock",name:"Google Sheets Dropdown",searchKeywords:"google sheets block square rectangle box".split(" "),getRenderData:function(a,b){var c=a.BoundingBox;return"sample"==b?(a=c.w>c.h?c.w:c.h,c=c.x<c.y?c.x:c.y,c={x:c,y:c,w:a,h:a},a=E(c),c=[{FillColor:"#FFFFFF",line:!1,Actions:[y(c,.321,.393),x(c,.75,.393),x(c,.75,.429),x(c,.321,.429),A()]},{FillColor:"#FFFFFF",line:!1,Actions:[y(c,.321,.536),x(c,.75,.536),x(c,.75,.571),x(c,.321,.571),A()]},
{FillColor:"#FFFFFF",line:!1,Actions:[y(c,.321,.679),x(c,.75,.679),x(c,.75,.714),x(c,.321,.714),A()]},{FillColor:"#FFFFFF",line:!1,Actions:[y(c,.25,.393),x(c,.286,.393),x(c,.286,.429),x(c,.25,.429),A()]},{FillColor:"#FFFFFF",line:!1,Actions:[y(c,.25,.536),x(c,.286,.536),x(c,.286,.571),x(c,.25,.571),A()]},{FillColor:"#FFFFFF",line:!1,Actions:[y(c,.25,.679),x(c,.286,.679),x(c,.286,.714),x(c,.25,.714),A()]}],a.concat(c)):v.baseRenderActions(c,a).concat(D("CMP_GoogleSheetsListBlock",a))},onInit:function(a){function b(){var b=
lucid.plugin.getProperty(a,"gs_SelectionRange")||"",d=b.indexOf(":");if(!(0>d)){var e=G(b.substring(0,d));d=G(b.substring(d+1));var g=F(a),h=lucid.plugin.getProperty(a,"gs_WorksheetId");g&&void 0!=h&&null!=h&&e&&d&&(lucid.computation.GoogleSheetCacher.getRange(g,h,e,d,a+":"+b,function(b){b=b.reduce(function(a,b){return a.concat(b)},[]);b=b.map(function(a){return String(a)});lucid.plugin.setPropertyIfChanged(a,"gs_SelectionOptions",b);var c=lucid.plugin.getProperty(a,"CMP_TXT_Value",!0);0>b.indexOf(c)&&
0<b.length&&(lucid.plugin.setProperty(a,"CMP_TXT_Value",b[0],!0),lucid.plugin.setProperty(a,"TextValue",b[0]),K(a))}),I(a,function(b){N(a,b)}))}}Q(a);lucid.plugin.setProperty(a,"CMP_IsEditable",!1);lucid.plugin.setProperty(a,"gs_SelectionRange","");lucid.plugin.setProperty(a,"gs_SelectionOptions",[]);lucid.plugin.setProperty(a,"TextValue","");lucid.plugin.hookPropertyPostSave(a,"gs_WorksheetId",b);lucid.plugin.hookPropertyPostSave(a,"gs_Cell",P(a,100));lucid.plugin.hookPropertyPostSave(a,"gs_SelectionRange",
b);lucid.plugin.hookPropertyPostSave(a,"TextValue",function(b,d){M(a,d)});lucid.plugin.setProperty(a,"CMP_UpdateFunction",b,!0);lucid.plugin.setProperty(a,"ChangeCallback",P(a,500),!0)}}));function R(a,b){b=lucid.plugin.getProperty(b,"InsetMargin")||0;return lucid.math.Box.safePad(a,-b)}function S(a,b){b=lucid.plugin.getProperty(b,"InsetMargin")||0;return lucid.math.Box.safePad(a,b)}
function T(a){var b=a;a=[];for(var c=[],d=/\$([A-Za-z]+)([0-9]*)\b((.|[\n\r])*)/,e=b.search(d);-1<e;)a.push(b.slice(0,e)),b=d.exec(b.slice(e)),c.push(b[1]+b[2]),b=b[3],e=b.search(d);0<b.length&&a.push(b);return{TextSegments:a,Cells:c}}
function U(a){var b=lucid.plugin.getProperty(a,"FormatValue",!0),c="";b.TextSegments.forEach(function(d,e){c+=d;if(b.Cells.length>e){d=lucid.plugin.getProperty(a,"Cell_"+b.Cells[e],!0);if(null===d||void 0===d)d="Loading";c+=d}});lucid.plugin.setPropertyIfChanged(a,"CMP_TXT_DisplayValue",c,!0)}
function V(a){lucid.plugin.getProperty(a,"FormatValue",!0).Cells.forEach(function(b){"val"==b?lucid.plugin.setPropertyIfChanged(a,"Cell_val",lucid.plugin.getProperty(a,"CMP_TXT_Value",!0)||0,!0):J(a,function(c){lucid.plugin.setPropertyIfChanged(a,"Cell_"+b,c,!0)},void 0,b)})}
lucid.plugin.initBlockClass(w({className:"CMP_GoogleSheetsDynamicTextBlock",name:"Google Sheets Markup Block",searchKeywords:["sheets","google","text","dynamic"],disabledPropertyControls:"LineWidth FillColor LineColor FillType StrokeStyle Rounding".split(" "),onInit:function(a){Q(a,!1);lucid.plugin.setProperty(a,"MarkupHasWatermark",!0);lucid.plugin.addBlockTextArea(a,{id:"DisplayValue",value:"Text",getBoundingBox:k.common.DocVersionedProps.getValueForDocVersion([{docVersionInstated:0,value:function(b){return lucid.math.Box.pad({x:b.x,
y:b.y,w:b.w,h:b.h},-(lucid.plugin.getProperty(a,"InsetMargin")||0))}},{docVersionInstated:5,value:function(b){return R(b,a,!0)}}]),wantReturn:!0,beforeTextEdit:function(){var b=lucid.plugin.getProperty(a,"CMP_IsEditable");b&&lucid.plugin.setProperty(a,"CMP_IsEditing",!0,!0);return b},afterTextEdit:function(){var b=lucid.plugin.getAllProperties(a,!0),c;for(c in b)0==c.indexOf("Cell_")&&lucid.plugin.setProperty(a,c,void 0,!0);lucid.plugin.setProperty(a,"CMP_IsEditing",!1,!0)}});lucid.plugin.setProperty(a,
"DisplayValue","Text");lucid.plugin.setProperty(a,"FormatValue",T("Text"),!0);lucid.plugin.setProperty(a,"Value",0);lucid.plugin.setProperty(a,"CMP_TXT_Value",0,!0);lucid.plugin.hookPropertyPostSave(a,"DisplayValue",function(){if(!(5<=(lucid.plugin.getProperty(null,"Version")||0))){var b="y",c="h",d=lucid.plugin.getProperty(a,"BoundingBox"),e=lucid.text.getTextAreaRotation(a,"Text"),g=lucid.math.Box.pad({x:d.x,y:d.y,w:d.w,h:d.h},-(lucid.plugin.getProperty(a,"InsetMargin")||0));0!==e%Math.PI&&(g=lucid.math.Box.rotate(g,
e),b="x",c="w");e=lucid.plugin.getProperty(a,"InsetMargin")||0;var h=lucid.plugin.getProperty(a,"TextVAlign");g=lucid.text.getSize(a,"Text",g);g.h+=2*e;g.h>d[c]&&("middle"==h?d[b]-=(g.h-d[c])/2:"bottom"==h&&(d[b]-=g.h-d[c]),d[c]=g.h,lucid.plugin.setProperty(a,"BoundingBox",d))}});lucid.plugin.hookPropertyPostSave(a,"DisplayValue",function(b,c){b=T(c.t);lucid.plugin.setPropertyIfChanged(a,"FormatValue",b,!0)});lucid.plugin.setProperty(a,"CMP_UpdateFunction",function(a){V(a);U(a)},!0);lucid.plugin.setProperty(a,
"CMP_IsEditable",!1);lucid.plugin.setProperty(a,"gs_Worksheets",[]);v.registerProperties(a)},onTextAreaOverflowChange:"undefined"!==typeof window?k.common.TextAreaOverflowUtils.getOnOverflowCallback(R,S):void 0,onCreate:function(a){lucid.help.item.accomplish("default.text.add");lucid.plugin.editBlockTextArea(a,"FormatValue")},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},getRenderData:function(a,b,c){var d=a.BoundingBox;if("sample"==b)return a=d.w>d.h?d.w:d.h,d=d.x<d.y?
d.x:d.y,d={x:d,y:d,w:a,h:a},a=E(d),d=[{FillColor:"#FFFFFF",line:!1,Actions:[y(d,.321,.393),x(d,.179,.517),x(d,.321,.679),x(d,.393,.679),x(d,.25,.517),x(d,.393,.393),x(d,.321,.393),A(),y(d,.75,.517),x(d,.607,.679),x(d,.679,.679),x(d,.821,.517),x(d,.679,.393),x(d,.607,.393),x(d,.75,.517),A(),y(d,.42,.786),x(d,.473,.786),x(d,.58,.286),x(d,.527,.286),x(d,.402,.786),A()]}],a.concat(d);b=lucid.plugin.getProperty(c,"MarkupHasWatermark")?D("CMP_GoogleSheetsDynamicTextBlock",a):[];return v.baseRenderActions(d,
a).concat(b)}}));lucid.plugin.createToolGroups({"Google Sheets":["CMP_GoogleSheetsInputBlock","CMP_GoogleSheetsOutputBlock","CMP_GoogleSheetsListBlock","CMP_GoogleSheetsDynamicTextBlock","CMP_AdditionSquareBlock"]});
//# sourceMappingURL=/js/plugins/v2/source-maps/computation.js.map

};
